<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="ExecutStatsMapper">

    <select id="selectProcessRunStsList" parameterType="java.util.Map" resultType="camelMap">
    /* ExecutStatsMapper.selectProcessRunStsList */
    
    SET ANSI_WARNINGS OFF
SET ARITHIGNORE ON
SET ARITHABORT OFF
    
        SELECT *
          FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                       , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
                       , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
                       , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
                       , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
                       , SUM(MON_TOT) AS MON_TOT
                  FROM (
                        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                               , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                          FROM (
                                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                                       , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                                       , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                                       , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                                       , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                                  FROM (
                                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
                                          FROM (
                                                SELECT   YMD
                                                       , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                                       , COMP_CD
                                                       , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                                       , PROCESS_CD
                                                       , PROCESS_NM
                                                       , SUESS_CNT
                                                  FROM TB_STS_TOT
                                                 WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                                   AND STATE_CD = '5'
			                                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                                     </if>
                                               ) S
                                         WHERE 1 = 1
                                         GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                                      )  AS result
                                 PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                              ) AA
                        WHERE 1 = 1

                        UNION ALL

                       SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                              , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                         FROM (
                               SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                                      , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                                      , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                                      , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                                      , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                                 FROM (
                                       SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
                                         FROM (
                                               SELECT   YMD
                                                      , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                                      , COMP_CD
                                                      , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                                      , PROCESS_CD
                                                      , PROCESS_NM
                                                      , FAIL_CNT
                                                 FROM TB_STS_TOT
                                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                                  AND STATE_CD IN ('2', '3', '4', '6')
		                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                                          AND COMP_CD =  #{searchCmpnyCd}
		                                        </if>
                                               ) S
                                         WHERE 1 = 1
                                         GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                                       )  AS result
                                PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                               ) AA
                        WHERE 1 = 1

                        UNION ALL

                       SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                              , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                              , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                              , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                              , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
                          FROM (
                                SELECT   YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
                                       , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                                  FROM (
                                        SELECT   YMD
                                               , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                               , COMP_CD
                                               , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                               , PROCESS_CD
                                               , PROCESS_NM
                                               , SUESS_CNT
                                               , FAIL_CNT
                                               , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                          FROM TB_STS_TOT
                                         WHERE YMD like CONCAT( #{searchYear} ,'%')
                                           AND STATE_CD IN ('2', '3', '4', '5', '6')
                                         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                           AND COMP_CD =  #{searchCmpnyCd}
                                         </if>
                                       ) S
                                 WHERE 1 = 1
                                 GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                                )  AS result
                         PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result

                         UNION ALL

                        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, SUM(MON_TOT) AS MON_TOT
                          FROM (
                                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
                                       , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                                       , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
                                  FROM (
                                        SELECT   YMD
                                               , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                               , COMP_CD
                                               , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                               , PROCESS_CD
                                               , PROCESS_NM
                                               , SUESS_CNT
                                               , FAIL_CNT
                                               , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                          FROM TB_STS_TOT
                                         WHERE YMD like CONCAT( #{searchYear} ,'%')
                                           AND STATE_CD IN ('2', '3', '4', '5', '6')
                                         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                           AND COMP_CD =  #{searchCmpnyCd}
                                         </if>
                                        ) S
                                  WHERE 1 = 1
                                  GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM

                                  UNION ALL

                                 SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'A' AS GBN
                                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                                   FROM TB_STS_TOT
                                  WHERE YMD LIKE  CONCAT( #{searchYear} ,'%')
                                  <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                  </if>
                                  GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM

                                  UNION ALL

                                 SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'B' AS GBN
                                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                                   FROM TB_STS_TOT
                                  WHERE YMD LIKE  CONCAT( #{searchYear} ,'%')
                                  <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                  </if>
                                  GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM

                                  UNION ALL

                                 SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
                                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                                   FROM TB_STS_TOT
                                  WHERE YMD LIKE  CONCAT( #{searchYear} ,'%')
                                  <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                  </if>
                                  GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                                 ) T
                           WHERE 1= 1
                           GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                          ) ZZ
                 WHERE 1= 1
                 GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN

                 UNION ALL

                SELECT   'ZZ' AS COMP_CD
                       , 'ZZ' AS COMP_NM
                       , 'ZZ' AS PROCESS_CD
                       , 'ZZ' AS PROCESS_NMGBN
                       , GBN
                       , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
                       , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
                       , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
                       , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
                       , SUM(MON_TOT) AS MON_TOT
                  FROM (
                        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                               , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                          FROM (
                                SELECT   GBN
                                       , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                                       , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                                       , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                                       , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                                  FROM (
                                        SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
                                          FROM (
                                                SELECT   YMD
                                                       , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                                       , SUESS_CNT
                                                  FROM TB_STS_TOT
                                                 WHERE YMD LIKE CONCAT(#{searchYear},'%')
                                                   AND STATE_CD = '5'
			                                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                                     </if>
                                               ) S
                                         WHERE 1 = 1
                                         GROUP BY YM
                                      )  AS result
                                 PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                              ) AA
                        WHERE 1 = 1

                        UNION ALL

                       SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                              , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                         FROM (
                               SELECT   GBN
                                      , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                                      , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                                      , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                                      , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                                 FROM (
                                       SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
                                         FROM (
                                               SELECT   YMD
                                                      , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                                      , FAIL_CNT
                                                 FROM TB_STS_TOT
                                                WHERE YMD LIKE CONCAT(#{searchYear},'%')
                                                  AND STATE_CD IN ('2', '3', '4', '6')
		                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                                          AND COMP_CD =  #{searchCmpnyCd}
		                                        </if>
                                               ) S
                                         WHERE 1 = 1
                                         GROUP BY YM
                                       )  AS result
                                PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                               ) AA
                        WHERE 1 = 1

                        UNION ALL

                       SELECT   GBN
                              , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                              , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                              , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                              , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
                          FROM (
                                SELECT   YM, 'TC' AS GBN
                                       , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                                  FROM (
                                        SELECT   YMD
                                               , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                               , SUESS_CNT
                                               , FAIL_CNT
                                               , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                          FROM TB_STS_TOT
                                         WHERE YMD like CONCAT(#{searchYear},'%')
                                           AND STATE_CD IN ('2', '3', '4', '5', '6')
                                         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                           AND COMP_CD =  #{searchCmpnyCd}
                                         </if>
                                        ) S
                                 WHERE 1 = 1
                                 GROUP BY YM
                                ) AS result
                         PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result

                         UNION ALL

                        SELECT   GBN
                               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, SUM(MON_TOT) AS MON_TOT
                          FROM (
                                SELECT  'TC' AS GBN
                                       , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                                       , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
                                  FROM (
                                        SELECT   YMD
                                               , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                               , SUESS_CNT
                                               , FAIL_CNT
                                               , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                          FROM TB_STS_TOT
                                         WHERE YMD like CONCAT(#{searchYear},'%')
                                           AND STATE_CD IN ('2', '3', '4', '5', '6')
	                                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
	                                       AND COMP_CD =  #{searchCmpnyCd}
	                                     </if>
                                        ) S
                                 WHERE 1 = 1

                                 UNION ALL

                                SELECT   'TA' AS GBN
                                       , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                                  FROM TB_STS_TOT
                                 WHERE YMD LIKE  CONCAT(#{searchYear},'%')
                                 <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                   AND COMP_CD =  #{searchCmpnyCd}
                                 </if>

                                 UNION ALL

                                SELECT   'TB' AS GBN
                                       , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                                  FROM TB_STS_TOT
                                 WHERE YMD LIKE  CONCAT(#{searchYear},'%')
                                 <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                   AND COMP_CD =  #{searchCmpnyCd}
                                 </if>

                                 UNION ALL

                                SELECT   'TC' AS GBN
                                       , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                                  FROM TB_STS_TOT
                                 WHERE YMD LIKE  CONCAT(#{searchYear},'%')
                                 <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                   AND COMP_CD =  #{searchCmpnyCd}
                                 </if>
                                ) T
                           WHERE 1= 1
                           GROUP BY GBN
                        ) ZZ
                 WHERE 1= 1
                 GROUP BY GBN
              ) Q
         ORDER BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
    </select>

    <select id="selectMonthPerDayCount" parameterType="java.util.Map" resultType="java.lang.Integer">
        /* TaskManageMapper.selectMonthPerDayCount */
            SELECT CAST( DATEPART(DD,DATEADD(DAY,-1,DATEADD(MONTH,1,DATEADD(DAY,-DATEPART(DD, CONCAT(#{searchYear},#{month},'01')  )+1,CONCAT(#{searchYear},#{month},'01'))))) AS INT) AS DAT_CNT
    </select>

    <select id="selectProcessMonthList" parameterType="java.util.Map" resultType="camelMap">
        /* TaskManageMapper.selectProcessMonthList */
        SET ANSI_WARNINGS OFF
SET ARITHIGNORE ON
SET ARITHABORT OFF
        SELECT *
          FROM (
        
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				       , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
				       , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
				       , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
				       , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
				       , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
				       , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
				       , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT
				  FROM (
				        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				               , D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				               , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
				          FROM (
				                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				                       , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				                       , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				                       , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				                       , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				                       , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				                       , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				                       , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				                       , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				                       , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				                       , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				                       , ISNULL(D31,0) AS D31
				                  FROM (
				                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
				                          FROM (
				                                SELECT   YMD
				                                       , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
				                                       , COMP_CD
				                                       , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                                       , PROCESS_CD
				                                       , PROCESS_NM
				                                       , SUESS_CNT
				                                  FROM TB_STS_TOT
				                                 WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
				                                   AND STATE_CD = '5'
			                                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                                     </if>
				                               ) S
				                         WHERE 1 = 1
				                         GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				                      )  AS result
				                 PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				              ) AA
				        WHERE 1 = 1
				
				        UNION ALL
				
				       SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				              , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
				         FROM (
				               SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				                      , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				                      , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				                      , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				                      , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				                      , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				                      , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				                      , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				                      , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				                      , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				                      , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				                      , ISNULL(D31,0) AS D31
				                 FROM (
				                       SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
				                         FROM (
				                               SELECT   YMD
				                                      , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
				                                      , COMP_CD
				                                      , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                                      , PROCESS_CD
				                                      , PROCESS_NM
				                                      , FAIL_CNT
				                                 FROM TB_STS_TOT
				                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
				                                  AND STATE_CD IN ('2', '3', '4', '6')
		                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                                          AND COMP_CD =  #{searchCmpnyCd}
		                                        </if>
				                               ) S
				                         WHERE 1 = 1
				                         GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				                       )  AS result
				                PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				               ) AA
				        WHERE 1 = 1
				
				        UNION ALL
				
				       SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				              , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				              , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				              , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				              , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				              , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				              , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				              , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				              , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				              , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				              , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				              , ISNULL(D31,0) AS D31, 0 AS MON_TOT
				          FROM (
				                SELECT   YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
				                       , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
				                  FROM (
				                        SELECT   YMD
				                               , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
				                               , COMP_CD
				                               , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                               , PROCESS_CD
				                               , PROCESS_NM
				                               , SUESS_CNT
				                               , FAIL_CNT
				                               , FAIL_CNT + SUESS_CNT AS TOT_CNT
				                          FROM TB_STS_TOT
				                         WHERE YMD like CONCAT(#{searchYear},'-',#{month},'%')
				                           AND STATE_CD IN ('2', '3', '4', '5', '6')
                                         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                           AND COMP_CD =  #{searchCmpnyCd}
                                         </if>
				                       ) S
				                 WHERE 1 = 1
				                 GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				                )  AS result
				        PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				
				        UNION ALL
				
				       SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				              , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
				              , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
				              , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
				              , SUM(MON_TOT) AS MON_TOT
				         FROM (
				               SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
				                      , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
				                      , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
				                      , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
				                      , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
				                 FROM (
				                       SELECT   YMD
				                              , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
				                              , COMP_CD
				                              , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                              , PROCESS_CD
				                              , PROCESS_NM
				                              , SUESS_CNT
				                              , FAIL_CNT
				                              , FAIL_CNT + SUESS_CNT AS TOT_CNT
				                         FROM TB_STS_TOT
				                        WHERE YMD like CONCAT(#{searchYear},'-',#{month},'%')
				                          AND STATE_CD IN ('2', '3', '4', '5', '6')
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                          AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
				                      ) S
				                WHERE 1 = 1
				                GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				
				                UNION ALL
				
				               SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'A' AS GBN
				                      , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
				                      , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
				                      , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
				                      , 0 AS MON_TOT
				                 FROM TB_STS_TOT
				                WHERE YMD LIKE  CONCAT(#{searchYear},'-',#{month},'%')
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                  AND COMP_CD =  #{searchCmpnyCd}
                                </if>
				                GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				
				                UNION ALL
				
				               SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'B' AS GBN
				                      , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
				                      , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
				                      , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
				                      , 0 AS MON_TOT
				                 FROM TB_STS_TOT
				                WHERE YMD LIKE  CONCAT(#{searchYear},'-',#{month},'%')
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                  AND COMP_CD =  #{searchCmpnyCd}
                                </if>
				                GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				
				                UNION ALL
				
				               SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
				                      , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
				                      , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
				                      , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
				                      , 0 AS MON_TOT
				                 FROM TB_STS_TOT
				                WHERE YMD LIKE  CONCAT(#{searchYear},'-',#{month},'%')
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                  AND COMP_CD =  #{searchCmpnyCd}
                                </if>
				                GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				               ) T
				         WHERE 1= 1
				         GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				       ) ZZ
				 WHERE 1= 1
				 GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
			 
                UNION ALL
 
               SELECT  'ZZ' AS COMP_CD
                     , 'ZZ' AS COMP_NM
                     , 'ZZ' AS PROCESS_CD
                     , 'ZZ' AS PROCESS_NMGBN
                     , GBN
                     , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
                     , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
                     , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
                     , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
                     , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
                     , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
                     , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT                     
                FROM (
                      SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                             , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
                        FROM (
                              SELECT   GBN
                     , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                     , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                     , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                     , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                     , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                     , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                     , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                     , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                     , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                     , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                     , ISNULL(D31,0) AS D31
                                FROM (
                                      SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
                                        FROM (
                                              SELECT   YMD
                                                     , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                                     , SUESS_CNT
                                                FROM TB_STS_TOT
                                               WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                                 AND STATE_CD = '5'
		                                       <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                                         AND COMP_CD =  #{searchCmpnyCd}
		                                       </if>
                                             ) S
                                       WHERE 1 = 1
                                       GROUP BY YM
                                    )  AS result
                               PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                            ) AA
                      WHERE 1 = 1

                      UNION ALL

                     SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                            , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
                       FROM (
                             SELECT   GBN
                     , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                     , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                     , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                     , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                     , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                     , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                     , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                     , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                     , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                     , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                     , ISNULL(D31,0) AS D31
                               FROM (
                                     SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
                                       FROM (
                                             SELECT   YMD
                                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                                    , FAIL_CNT
                                               FROM TB_STS_TOT
                                              WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                                AND STATE_CD IN ('2', '3', '4', '6')
		                                      <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                                        AND COMP_CD =  #{searchCmpnyCd}
		                                      </if>
                                             ) S
                                       WHERE 1 = 1
                                       GROUP BY YM
                                     )  AS result
                              PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                             ) AA
                      WHERE 1 = 1

                      UNION ALL

                     SELECT   GBN
                     , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                     , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                     , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                     , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                     , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                     , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                     , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                     , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                     , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                     , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                     , ISNULL(D31,0) AS D31, 0 AS MON_TOT
                        FROM (
                              SELECT   YM, 'TC' AS GBN
                                     , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                                FROM (
                                      SELECT   YMD
                                             , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                             , SUESS_CNT
                                             , FAIL_CNT
                                             , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                        FROM TB_STS_TOT
                                       WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                         AND STATE_CD IN ('2', '3', '4', '5', '6')
                                       <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                         AND COMP_CD =  #{searchCmpnyCd}
                                       </if>
                                      ) S
                               WHERE 1 = 1
                               GROUP BY YM
                              ) AS result
                       PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result

                       UNION ALL

                      SELECT   GBN
                              , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                              , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                              , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                             , SUM(MON_TOT) AS MON_TOT
                        FROM (
                              SELECT  'TC' AS GBN
                                     , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                                     , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                                     , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                                     , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
                                FROM (
                                      SELECT   YMD
                                             , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                             , SUESS_CNT
                                             , FAIL_CNT
                                             , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                        FROM TB_STS_TOT
                                       WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                         AND STATE_CD IN ('2', '3', '4', '5', '6')
						               <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
						                 AND COMP_CD =  #{searchCmpnyCd}
						               </if>
                                      ) S
                               WHERE 1 = 1

                               UNION ALL

                              SELECT   'TA' AS GBN
                                     , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                                     , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                                     , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                                     , 0 AS MON_TOT
                                FROM TB_STS_TOT
                               WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')

                               UNION ALL

                              SELECT   'TB' AS GBN
                                     , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                                     , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                                     , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                                     , 0 AS MON_TOT
                                FROM TB_STS_TOT
                               WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')

                               UNION ALL

                              SELECT   'TC' AS GBN
                                     , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                                     , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                                     , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                                     , 0 AS MON_TOT
                                FROM TB_STS_TOT
                               WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                              ) T
                         WHERE 1= 1
                         GROUP BY GBN
                      ) ZZ
               WHERE 1= 1
               
               GROUP BY GBN
			 
			 ) Q

			 ORDER BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
    </select>


    <select id="selectRobotRunYearStsList" parameterType="java.util.Map" resultType="camelMap">
    /* ExecutStatsMapper.selectRobotRunYearStsList */
    
    SET ANSI_WARNINGS OFF
	SET ARITHIGNORE ON
	SET ARITHABORT OFF

		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
		       , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
		       , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
		       , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
		       , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
		       , SUM(MON_TOT) AS MON_TOT
		  FROM (
		        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
		               , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
		               , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
		               , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
		               , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
		               , ISNULL(M01,0)+ISNULL(M02,0)+ISNULL(M03,0)+ISNULL(M04,0)+ISNULL(M05,0)+ISNULL(M06,0)+ISNULL(M07,0)+ISNULL(M08,0)+ISNULL(M09,0)+ISNULL(M10,0)+ISNULL(M11,0)+ISNULL(M12,0)  AS MON_TOT
		          FROM (
		                SELECT   YM
		                       , COMP_CD
		                       , COMP_NM
		                       , ROBOT_ID
		                       , BOT_NM
		                       , SUM(SUESS_CNT) AS SUESS_CNT
		                       , 'A' AS GBN
		                  FROM (
		                        SELECT   CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
		                               , TENANT_ID
		                               , COMP_CD
		                               <!-- , COMP_NM -->
		                               , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
		                               , ROBOT_ID
		                               , BOT_NM
		                               , SUESS_CNT
		                          FROM TB_STS_TOT
		                         WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
		                           AND STATE_CD = '5'
		                         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                           AND COMP_CD =  #{searchCmpnyCd}
		                         </if>
		                       ) A
		                 WHERE 1 = 1
		                 GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		                )  AS result
		         PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
		 
		         UNION ALL
		
		        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
		               , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
		               , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
		               , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
		               , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
		               , ISNULL(M01,0)+ISNULL(M02,0)+ISNULL(M03,0)+ISNULL(M04,0)+ISNULL(M05,0)+ISNULL(M06,0)+ISNULL(M07,0)+ISNULL(M08,0)+ISNULL(M09,0)+ISNULL(M10,0)+ISNULL(M11,0)+ISNULL(M12,0)  AS MON_TOT
		          FROM (
		                SELECT   YM
		                       , COMP_CD
		                       , COMP_NM
		                       , ROBOT_ID
		                       , BOT_NM
		                       , SUM(FAIL_CNT) AS FAIL_CNT
		                       , 'B' AS GBN
		                  FROM (
		                        SELECT   CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
		                               , TENANT_ID
		                               , COMP_CD
		                               <!-- , COMP_NM -->
		                               , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
		                               , ROBOT_ID
		                               , BOT_NM
		                               , FAIL_CNT
		                          FROM TB_STS_TOT
		                         WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
		                           AND STATE_CD IN ('2', '3', '4', '6')
		                         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                           AND COMP_CD =  #{searchCmpnyCd}
		                         </if>
		                       ) A
		                 WHERE 1 = 1
		                 GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		                )  AS result
		         PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
		
		         UNION ALL
		
		         SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
		                , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
		                , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
		                , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
		                , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
		                , 0 AS MON_TOT
		          FROM (
		                SELECT   YM
		                       , COMP_CD
		                       , COMP_NM
		                       , ROBOT_ID
		                       , BOT_NM
		                       , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
		                       , 'C' AS GBN
		                  FROM (
		                        SELECT   CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
		                               , TENANT_ID
		                               , COMP_CD
		                               <!-- , COMP_NM -->
		                               , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
		                               , ROBOT_ID
		                               , BOT_NM
		                               , SUESS_CNT
		                               , FAIL_CNT
		                               , FAIL_CNT + SUESS_CNT AS TOT_CNT
		                          FROM TB_STS_TOT
		                         WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
		                           AND STATE_CD IN ('2', '3', '4', '5', '6')
		                         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                           AND COMP_CD =  #{searchCmpnyCd}
		                         </if>
		                       ) A
		                 WHERE 1 = 1
		                 GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		                )  AS result
		         PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
		
		         UNION ALL
		
		        SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'A' AS GBN
		               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
		          FROM TB_STS_TOT
		         WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
		         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		           AND COMP_CD =  #{searchCmpnyCd}
		         </if>
		         GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		
		         UNION ALL
		
		        SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'B' AS GBN
		               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
		          FROM TB_STS_TOT
		         WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
		         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		           AND COMP_CD =  #{searchCmpnyCd}
		         </if>
		         GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		
		         UNION ALL
		
		        SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
		               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
		          FROM TB_STS_TOT
		         WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
		         <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		           AND COMP_CD =  #{searchCmpnyCd}
		         </if>
		         GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		
		         UNION ALL
		
		          SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
		                 , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
		            FROM (
		                  SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
		                         , SUM(SUESS_CNT) AS SUESS_CNT , SUM(TOT_CNT) AS TOT_CNT
		                    FROM (
		                          SELECT   YMD
		                                 , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
		                                 , COMP_CD
		                                 , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
		                                 , ROBOT_ID
		                                 , BOT_NM
		                                 , SUESS_CNT
		                                 , FAIL_CNT + SUESS_CNT AS TOT_CNT
		                            FROM TB_STS_TOT
		                           WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
		                             AND STATE_CD IN ('2', '3', '4', '5', '6')
		                           <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                             AND COMP_CD =  #{searchCmpnyCd}
		                           </if>
		                          ) S
		                    WHERE 1 = 1
		                    GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		                  ) C
		           GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
		        ) X
		 WHERE 1 = 1
		 GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
		 
		 UNION ALL

        SELECT   'ZZ' AS COMP_CD
               , 'ZZ' AS COMP_NM
               , 0 AS ROBOT_ID
               , 'ZZ' AS BOT_NM
               , GBN
               , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
               , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
               , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
               , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
               , SUM(MON_TOT) AS MON_TOT
          FROM (
                SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                       , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                  FROM (
                        SELECT   GBN
                               , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                               , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                               , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                               , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                          FROM (
                                SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
                                  FROM (
                                        SELECT   YMD
                                               , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                               , SUESS_CNT
                                          FROM TB_STS_TOT
                                         WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                           AND STATE_CD = '5'
                              <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                  AND COMP_CD =  #{searchCmpnyCd}
                              </if>
                                       ) S
                                 WHERE 1 = 1
                                 GROUP BY YM
                              )  AS result
                         PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                      ) AA
                WHERE 1 = 1

                UNION ALL

               SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                      , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                 FROM (
                       SELECT   GBN
                              , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                              , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                              , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                              , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                         FROM (
                               SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
                                 FROM (
                                       SELECT   YMD
                                              , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                              , FAIL_CNT
                                         FROM TB_STS_TOT
                                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                          AND STATE_CD IN ('2', '3', '4', '6')
                                       <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                          AND COMP_CD =  #{searchCmpnyCd}
                                       </if>
                                       ) S
                                 WHERE 1 = 1
                                 GROUP BY YM
                               )  AS result
                        PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                       ) AA
                WHERE 1 = 1

                UNION ALL

               SELECT   GBN
                      , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                      , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                      , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                      , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
                  FROM (
                        SELECT   YM, 'TC' AS GBN
                               , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                          FROM (
                                SELECT   YMD
                                       , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                       , SUESS_CNT
                                       , FAIL_CNT
                                       , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                  FROM TB_STS_TOT
                                 WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                   AND STATE_CD IN ('2', '3', '4', '5', '6')
                               <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                   AND COMP_CD =  #{searchCmpnyCd}
                               </if>
                                ) S
                         WHERE 1 = 1
                         GROUP BY YM
                        ) AS result
                 PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result

                 UNION ALL

                SELECT   GBN
                       , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, SUM(MON_TOT) AS MON_TOT
                  FROM (
                        SELECT  'TC' AS GBN
                               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                               , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
                          FROM (
                                SELECT   YMD
                                       , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                       , SUESS_CNT
                                       , FAIL_CNT
                                       , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                  FROM TB_STS_TOT
                                 WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                   AND STATE_CD IN ('2', '3', '4', '5', '6')
                               <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                   AND COMP_CD =  #{searchCmpnyCd}
                               </if>
                                ) S
                         WHERE 1 = 1

                         UNION ALL

                        SELECT   'TA' AS GBN
                               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                          FROM TB_STS_TOT
                         WHERE YMD LIKE  CONCAT( #{searchYear} ,'%')
                       <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                           AND COMP_CD =  #{searchCmpnyCd}
                       </if>

                         UNION ALL

                        SELECT   'TB' AS GBN
                               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                          FROM TB_STS_TOT
                         WHERE YMD LIKE  CONCAT( #{searchYear} ,'%')
                       <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                           AND COMP_CD =  #{searchCmpnyCd}
                       </if>
                         UNION ALL

                        SELECT   'TC' AS GBN
                               , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
                          FROM TB_STS_TOT
                         WHERE YMD LIKE  CONCAT( #{searchYear} ,'%')
                       <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                           AND COMP_CD =  #{searchCmpnyCd}
                       </if>
                        ) T
                   WHERE 1= 1
                   GROUP BY GBN
                ) ZZ
         WHERE 1= 1
         GROUP BY GBN
		 ORDER BY COMP_CD, ROBOT_ID, GBN
    </select>

    <select id="selectRobotRunMonthStsList" parameterType="java.util.Map" resultType="camelMap">
    /* ExecutStatsMapper.selectRobotRunMonthStsList */
    
        SET ANSI_WARNINGS OFF
    SET ARITHIGNORE ON
    SET ARITHABORT OFF
    
            SELECT   COMP_CD, 
            COMP_NM        
            , ROBOT_ID, BOT_NM, GBN
                    , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
                    , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
                    , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
                    , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
                    , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
                    , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
                    , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT
              FROM (
                    SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                           , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                           , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                           , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                           , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                           , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                           , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                           , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                           , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                           , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                           , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                           , ISNULL(D31,0) AS D31
                           , ISNULL(D01,0)+ISNULL(D02,0)+ISNULL(D03,0)+ISNULL(D04,0)+ISNULL(D05,0)+ISNULL(D06,0)+
                             ISNULL(D07,0)+ISNULL(D08,0)+ISNULL(D09,0)+ISNULL(D10,0)+ISNULL(D11,0)+ISNULL(D12,0)+
                             ISNULL(D13,0)+ISNULL(D14,0)+ISNULL(D15,0)+ISNULL(D16,0)+ISNULL(D17,0)+ISNULL(D18,0)+
                             ISNULL(D19,0)+ISNULL(D20,0)+ISNULL(D21,0)+ISNULL(D22,0)+ISNULL(D23,0)+ISNULL(D24,0)+
                             ISNULL(D25,0)+ISNULL(D26,0)+ISNULL(D27,0)+ISNULL(D28,0)+ISNULL(D29,0)+ISNULL(D30,0)+
                             ISNULL(D31,0) AS MON_TOT
                      FROM (
                            SELECT   YM
                                   , COMP_CD
                                   , COMP_NM
                                   , ROBOT_ID
                                   , BOT_NM
                                   , SUM(SUESS_CNT) AS SUESS_CNT
                                   , 'A' AS GBN
                              FROM (
                                    SELECT   CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                           , TENANT_ID
                                           , COMP_CD
                                           , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                           , ROBOT_ID
                                           , BOT_NM
                                           , SUESS_CNT
                                      FROM TB_STS_TOT
                                     WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                       AND STATE_CD = '5'
                                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                       AND COMP_CD =  #{searchCmpnyCd}
                                     </if>
                                   ) A
                             WHERE 1 = 1
                             GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                            )  AS result
                     PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
             
                     UNION ALL
            
                    SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                           , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                           , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                           , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                           , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                           , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                           , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                           , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                           , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                           , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                           , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                           , ISNULL(D31,0) AS D31
                           , ISNULL(D01,0)+ISNULL(D02,0)+ISNULL(D03,0)+ISNULL(D04,0)+ISNULL(D05,0)+ISNULL(D06,0)+
                             ISNULL(D07,0)+ISNULL(D08,0)+ISNULL(D09,0)+ISNULL(D10,0)+ISNULL(D11,0)+ISNULL(D12,0)+
                             ISNULL(D13,0)+ISNULL(D14,0)+ISNULL(D15,0)+ISNULL(D16,0)+ISNULL(D17,0)+ISNULL(D18,0)+
                             ISNULL(D19,0)+ISNULL(D20,0)+ISNULL(D21,0)+ISNULL(D22,0)+ISNULL(D23,0)+ISNULL(D24,0)+
                             ISNULL(D25,0)+ISNULL(D26,0)+ISNULL(D27,0)+ISNULL(D28,0)+ISNULL(D29,0)+ISNULL(D30,0)+
                             ISNULL(D31,0) AS MON_TOT
                      FROM (
                            SELECT   YM
                                   , COMP_CD
                                   , COMP_NM
                                   , ROBOT_ID
                                   , BOT_NM
                                   , SUM(FAIL_CNT) AS FAIL_CNT
                                   , 'B' AS GBN
                              FROM (
                                    SELECT   CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                           , TENANT_ID
                                           , COMP_CD
                                           , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                           , ROBOT_ID
                                           , BOT_NM
                                           , FAIL_CNT
                                      FROM TB_STS_TOT
                                     WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                       AND STATE_CD IN ('2', '3', '4', '6')
                                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                       AND COMP_CD =  #{searchCmpnyCd}
                                     </if>
                                   ) A
                             WHERE 1 = 1
                             GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                            )  AS result
                     PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
            
                     UNION ALL
            
                     SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                            , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                            , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                            , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                            , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                            , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                            , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                            , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                            , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                            , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                            , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                            , ISNULL(D31,0) AS D31, 0 AS MON_TOT
                      FROM (
                            SELECT   YM
                                   , COMP_CD
                                   , COMP_NM
                                   , ROBOT_ID
                                   , BOT_NM
                                   , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                                   , 'C' AS GBN
                              FROM (
                                    SELECT   CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                           , TENANT_ID
                                           , COMP_CD
                                           , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                           , ROBOT_ID
                                           , BOT_NM
                                           , SUESS_CNT
                                           , FAIL_CNT
                                           , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                      FROM TB_STS_TOT
                                     WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                       AND STATE_CD IN ('2', '3', '4', '5', '6')
                                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                       AND COMP_CD =  #{searchCmpnyCd}
                                     </if>
                                   ) A
                             WHERE 1 = 1
                             GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                            )  AS result
                     PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
            
                     UNION ALL
            
                    SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'A' AS GBN
                           , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                           , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                           , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31, 0 AS MON_TOT
                      FROM TB_STS_TOT
                     WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                       AND COMP_CD =  #{searchCmpnyCd}
                     </if>
                     GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
            
                     UNION ALL
            
                    SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'B' AS GBN
                           , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                           , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                           , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31, 0 AS MON_TOT
                      FROM TB_STS_TOT
                     WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                       AND COMP_CD =  #{searchCmpnyCd}
                     </if>
                     GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
            
                     UNION ALL
            
                    SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
                           , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                           , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                           , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31, 0 AS MON_TOT
                      FROM TB_STS_TOT
                     WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                     <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                       AND COMP_CD =  #{searchCmpnyCd}
                     </if>
                     GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
            
                     UNION ALL
            
                      SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN 
                             , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                             , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                             , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                             , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
                        FROM (
                              SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
                                     , SUM(SUESS_CNT) AS SUESS_CNT , SUM(TOT_CNT) AS TOT_CNT
                                FROM (
                                      SELECT   YMD
                                             , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                             , COMP_CD
                                             , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                             , ROBOT_ID
                                             , BOT_NM
                                             , SUESS_CNT
                                             , FAIL_CNT + SUESS_CNT AS TOT_CNT
                                        FROM TB_STS_TOT
                                       WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                         AND STATE_CD IN ('2', '3', '4', '5', '6')
                                       <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                         AND COMP_CD =  #{searchCmpnyCd}
                                       </if>
                                      ) S
                                WHERE 1 = 1
                                GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                              ) C
                       GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                    ) X
             WHERE 1 = 1
             GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
             
             UNION ALL
		
		    SELECT   'ZZ' AS COMP_CD
		           , 'ZZ' AS COMP_NM
		           , 0 AS ROBOT_ID
		           , 'ZZ' AS BOT_NM
		           , GBN
		           , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
		           , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
		           , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
		           , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
		           , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
		           , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
		           , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT
		      FROM (
		            SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
		                   , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
		              FROM (
		                    SELECT   GBN
		                           , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
		                           , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
		                           , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
		                           , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
		                           , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
		                           , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
		                           , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
		                           , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
		                           , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
		                           , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
		                           , ISNULL(D31,0) AS D31
		                      FROM (
		                            SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
		                              FROM (
		                                    SELECT   YMD
		                                           , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
		                                           , SUESS_CNT
		                                      FROM TB_STS_TOT
		                                     WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
		                                       AND STATE_CD = '5'
		                          <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                              AND COMP_CD =  #{searchCmpnyCd}
		                          </if>
		                                   ) S
		                             WHERE 1 = 1
		                             GROUP BY YM
		                          )  AS result
		                     PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
		                  ) AA
		            WHERE 1 = 1
		
		            UNION ALL
		
		           SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
		                  , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
		             FROM (
		                   SELECT   GBN
		                           , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
		                           , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
		                           , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
		                           , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
		                           , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
		                           , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
		                           , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
		                           , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
		                           , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
		                           , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
		                           , ISNULL(D31,0) AS D31
		                     FROM (
		                           SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
		                             FROM (
		                                   SELECT   YMD
		                                          , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
		                                          , FAIL_CNT
		                                     FROM TB_STS_TOT
		                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
		                                      AND STATE_CD IN ('2', '3', '4', '6')
		                                   <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                                      AND COMP_CD =  #{searchCmpnyCd}
		                                   </if>
		                                   ) S
		                             WHERE 1 = 1
		                             GROUP BY YM
		                           )  AS result
		                    PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
		                   ) AA
		            WHERE 1 = 1
		
		            UNION ALL
		
		           SELECT   GBN
		                  , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
		                  , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
		                  , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
		                  , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
		                  , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
		                  , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
		                  , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
		                  , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
		                  , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
		                  , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
		                  , ISNULL(D31,0) AS D31, 0 AS MON_TOT
		              FROM (
		                    SELECT   YM, 'TC' AS GBN
		                           , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
		                      FROM (
		                            SELECT   YMD
		                                   , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
		                                   , SUESS_CNT
		                                   , FAIL_CNT
		                                   , FAIL_CNT + SUESS_CNT AS TOT_CNT
		                              FROM TB_STS_TOT
		                             WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
		                               AND STATE_CD IN ('2', '3', '4', '5', '6')
		                           <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                               AND COMP_CD =  #{searchCmpnyCd}
		                           </if>
		                            ) S
		                     WHERE 1 = 1
		                     GROUP BY YM
		                    ) AS result
		             PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
		
		             UNION ALL
		
		            SELECT   GBN
		                   , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
		                   , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
		                   , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
		                   , SUM(MON_TOT) AS MON_TOT
		              FROM (
		                    SELECT  'TC' AS GBN
		                           , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
		                           , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
		                           , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
		                           , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
		                      FROM (
		                            SELECT   YMD
		                                   , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
		                                   , SUESS_CNT
		                                   , FAIL_CNT
		                                   , FAIL_CNT + SUESS_CNT AS TOT_CNT
		                              FROM TB_STS_TOT
		                             WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
		                               AND STATE_CD IN ('2', '3', '4', '5', '6')
		                           <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                               AND COMP_CD =  #{searchCmpnyCd}
		                           </if>
		                            ) S
		                     WHERE 1 = 1
		
		                     UNION ALL
		
		                    SELECT   'TA' AS GBN
		                           , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
		                           , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
		                           , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31, 0 AS MON_TOT
		                      FROM TB_STS_TOT
		                     WHERE YMD LIKE  CONCAT(#{searchYear},'-',#{month},'%')
		                   <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                       AND COMP_CD =  #{searchCmpnyCd}
		                   </if>
		
		                     UNION ALL
		
		                    SELECT   'TB' AS GBN
		                           , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
		                           , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
		                           , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31, 0 AS MON_TOT
		                      FROM TB_STS_TOT
		                     WHERE YMD LIKE  CONCAT(#{searchYear},'-',#{month},'%')
		                   <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                       AND COMP_CD =  #{searchCmpnyCd}
		                   </if>
		                     UNION ALL
		
		                    SELECT   'TC' AS GBN
		                           , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
		                           , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
		                           , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31, 0 AS MON_TOT
		                      FROM TB_STS_TOT
		                     WHERE YMD LIKE  CONCAT(#{searchYear},'-',#{month},'%')
		                   <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                       AND COMP_CD =  #{searchCmpnyCd}
		                   </if>
		                    ) T
		               WHERE 1= 1
		               GROUP BY GBN
		            ) ZZ
		     WHERE 1= 1
		     GROUP BY GBN
		     ORDER BY COMP_CD, ROBOT_ID, GBN
    </select>


    <select id="selectNpRobotStatusList" parameterType="java.util.Map" resultType="camelMap">
    /* ExecutStatsMapper.selectNpRobotStatusList */
    
        SET ANSI_WARNINGS OFF
    SET ARITHIGNORE ON
    SET ARITHABORT OFF
    
		SELECT   CMPNY_CD
		       , CMPNY_NM
		       , GBN
		       , ROLE_CD
		       , ROLE_NM
		       , SUM(USER_CNT) AS USER_CNT
		  FROM (    
		    
				SELECT   CMPNY_CD
				       , CMPNY_NM
				       , GBN
				       , '' AS ROLE_CD
				       , '' AS ROLE_NM
				       , SUM(USER_CNT) AS USER_CNT
				  FROM (
				        SELECT   A.CD AS CMPNY_CD
				               , A.CD_NM AS CMPNY_NM
				               , 'A' AS GBN
				               , 0 AS USER_CNT
				          FROM   TB_CMMN_CD A
				               , TB_ROLE B
				         WHERE A.CLS_CD = '0024'
				           AND A.USE_AT = 'Y'
				         UNION ALL
				        SELECT   C.CMPNY_CD
				               , D.CD_NM AS CMPNY_NM
				               , 'A' AS GBN
				               , COUNT(A.USER_ID) AS USER_CNT
				          FROM TB_USER_ROLE A
				               LEFT OUTER JOIN TB_ROLE B ON B.USE_AT = 'Y' AND A.ROLE_CD = B.ROLE_CD
				               , TB_USER_BAS C
				               LEFT OUTER JOIN TB_CMMN_CD D ON D.CLS_CD = '0024' AND D.USE_AT = 'Y' AND C.CMPNY_CD =D.CD
				         WHERE 1 = 1
				         AND D.CD_NM IS NOT NULL
				           AND A.USER_ID = C.USER_ID
				           AND C.CMPNY_CD NOT IN ('W')
				         GROUP BY C.CMPNY_CD, D.CD_NM
				       ) T
				 GROUP BY CMPNY_CD,  CMPNY_NM, GBN
				
				 UNION ALL
				
				SELECT   CMPNY_CD
				       , CMPNY_NM
				       , GBN
				       , ROLE_CD
				       , ROLE_NM
				       , SUM(USER_CNT) AS USER_CNT
				  FROM (
				        SELECT   A.CD AS CMPNY_CD
				               , A.CD_NM AS CMPNY_NM
				               , 'B' AS GBN
				               , B.ROLE_CD
				               , B.ROLE_NM
				               , 0 AS USER_CNT
				          FROM   TB_CMMN_CD A
				               , TB_ROLE B
				         WHERE A.CLS_CD = '0024'
				           AND A.USE_AT = 'Y'
				         UNION ALL
				        SELECT   C.CMPNY_CD
				               , D.CD_NM AS CMPNY_NM
				               , 'B' AS GBN
				               , A.ROLE_CD
				               , B.ROLE_NM
				               , COUNT(A.USER_ID) AS USER_CNT
				          FROM TB_USER_ROLE A
				               LEFT OUTER JOIN TB_ROLE B ON B.USE_AT = 'Y' AND A.ROLE_CD = B.ROLE_CD
				               , TB_USER_BAS C
				               LEFT OUTER JOIN TB_CMMN_CD D ON D.CLS_CD = '0024' AND D.USE_AT = 'Y' AND C.CMPNY_CD =D.CD
				         WHERE 1 = 1
				         AND D.CD_NM IS NOT NULL
				           AND A.USER_ID = C.USER_ID
				           AND C.CMPNY_CD NOT IN ('W')
				         GROUP BY C.CMPNY_CD, D.CD_NM, A.ROLE_CD, B.ROLE_NM
				       ) T
				 GROUP BY CMPNY_CD,  CMPNY_NM, ROLE_CD, ROLE_NM, GBN
				
				 UNION ALL
				
				SELECT   CMPNY_CD
				       , CMPNY_NM
				       , GBN
				       , ROLE_CD
				       , ROLE_NM
				       , SUM(BOT_CNT) AS BOT_CNT
				  FROM (
				  
				            SELECT 
							B.CD_NM AS CMPNY_CD
							, C.CD_NM AS CMPNY_NM
							, 'C' AS GBN
							, '' AS ROLE_CD
							, '' AS ROLE_NM
							, COUNT(A.ID) AS BOT_CNT
							FROM SY_ROBOTS A
							LEFT OUTER JOIN TB_CMMN_CD B ON A.TENANTID = B.CD AND B.CLS_CD = '0034'
							LEFT OUTER JOIN TB_CMMN_CD C ON C.CLS_CD = '0024' AND C.USE_AT = 'Y' AND B.CD_NM =C.CD
							WHERE A.ISDELETED = 0
							GROUP BY A.TENANTID, B.CD_NM, C.CD_NM
							
							UNION ALL
							
							SELECT   
							B.CD_NM AS CMPNY_CD
							, A.CD_NM AS CMPNY_NM
							, 'C' AS GBN
							, '' AS ROLE_CD
							, '' AS ROLE_NM
							, 0 AS BOT_CNT
							FROM TB_CMMN_CD A
							INNER JOIN TB_CMMN_CD B ON A.CLS_CD = '0024' AND B.CLS_CD = '0034' AND A.CD = B.CD_NM AND A.USE_AT = 'Y' AND B.USE_AT = 'Y'
	  
					        <!-- SELECT   B.CD_NM AS CMPNY_CD
					               , C.CD_NM AS CMPNY_NM
					               , 'C' AS GBN
					               , '' AS ROLE_CD
					               , '' AS ROLE_NM
					               , COUNT(A.ID) AS BOT_CNT
					          FROM SY_ROBOTS A
					               LEFT OUTER JOIN TB_CMMN_CD B ON A.TenantId = B.CD AND B.CLS_CD = '0034'
					               LEFT OUTER JOIN TB_CMMN_CD C ON C.CLS_CD = '0024' AND C.USE_AT = 'Y' AND B.CD_NM =C.CD
					         WHERE 1 = 1
					         GROUP BY A.TenantId, B.CD_NM, C.CD_NM
					
					         UNION ALL
					
					        SELECT   B.CD_NM AS CMPNY_CD
					               , C.CD_NM AS CMPNY_NM
					               , 'C' AS GBN
					               , '' AS ROLE_CD
					               , '' AS ROLE_NM
					               , 0 AS BOT_CNT
					          FROM SY_ROBOTS A
					               LEFT OUTER JOIN TB_CMMN_CD B ON A.TenantId = B.CD AND B.CLS_CD = '0034'
					               LEFT OUTER JOIN TB_CMMN_CD C ON C.CLS_CD = '0024' AND C.USE_AT = 'Y' AND B.CD_NM =C.CD
					         WHERE 1 = 1
					         GROUP BY B.CD_NM, C.CD_NM -->
				       ) X
				 GROUP BY CMPNY_CD, CMPNY_NM, GBN, ROLE_CD, ROLE_NM
		         ) Z
         GROUP BY CMPNY_CD, CMPNY_NM, GBN, ROLE_CD, ROLE_NM
		 ORDER BY CMPNY_CD, GBN, ROLE_CD
    </select>

    <select id="selectRoleCdCount" parameterType="java.util.Map" resultType="java.lang.Integer">
        /* ExecutStatsMapper.selectRoleCdCount */
           SELECT COUNT(ROLE_CD) AS ROLE_CNT
             FROM TB_ROLE
            WHERE USE_AT = 'Y'
    </select>
        
    
    <select id="selectPlanAgainstPerforStatusList" parameterType="java.util.Map" resultType="camelMap">
        /* ExecutStatsMapper.selectPlanAgainstPerforStatusList */
		SELECT   CMPNY_CD
		       , CMPNY_NM
		       , GBN
		       , TC_CNT
		       , MC_CNT
		       , ROUND(PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT,1)  AS SUM_NO1
		       , PI_CNT
		       , ROUND(SANG_CNT+PWU_CNT+OUT_CNT,1) AS SUM_NO2
		       , SANG_CNT
		       , PWU_CNT
		       , OUT_CNT
		       , CASE WHEN GBN = 'A' THEN  ROUND(PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT - MC_CNT,1)
		              WHEN GBN = 'B' THEN  ROUND(PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT - MC_CNT,1)
		              ELSE 0
		         END AS DIF_CNT
               , CASE WHEN GBN = 'A' THEN  
                                          CASE WHEN MC_CNT > 0 THEN ROUND( ( PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT ) / MC_CNT *100,1) 
                                               ELSE 0
                                           END
                      WHEN GBN = 'B' THEN  
                                          CASE WHEN MC_CNT > 0 THEN ROUND( ( PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT ) / MC_CNT *100,1) 
                                               ELSE 0
                                           END
                      ELSE 0
                 END AS SUC_PER
		  FROM (
		        SELECT   CMPNY_CD
		               , Y.CD_NM AS CMPNY_NM
		               , GBN
		               , SUM(TC_CNT) AS TC_CNT
		               , SUM(MC_CNT) AS MC_CNT
		               , SUM(PI_CNT) AS PI_CNT
		               , SUM(SANG_CNT) AS SANG_CNT
		               , SUM(PWU_CNT) AS PWU_CNT
		               , SUM(OUT_CNT) AS OUT_CNT
		          FROM (
		                SELECT   CMPNY_CD
		                       , 'A' AS GBN
		                       , SUM(TC_PLAN) + SUM(TC_PI) AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(YYYYMM,1,4) AS YYYY
		                               , SUBSTRING(YYYYMM,5,2) AS MM
		                               , CMPNY_CD
		                               , TC_PLAN
		                               , TC_PI
		                               , TIME_PLAN
		                               , TIME_PI
		                          FROM TB_PERFOR_PLAN
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                        ) A
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'B' AS GBN
		                       , SUM(TIME_PLAN) + SUM(TIME_PI) AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(YYYYMM,1,4) AS YYYY
		                               , SUBSTRING(YYYYMM,5,2) AS MM
		                               , CMPNY_CD
		                               , TC_PLAN
		                               , TC_PI
		                               , TIME_PLAN
		                               , TIME_PI
		                          FROM TB_PERFOR_PLAN
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                        ) A
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT  CMPNY_CD
		                       , 'C' AS GBN
		                       , CASE WHEN SUM(TC_PLAN) + SUM(TC_PI) &gt; 0 AND SUM(TIME_PLAN) + SUM(TIME_PI) &gt; 0
		                              THEN ROUND(CONVERT(FLOAT,SUM(TIME_PLAN)+SUM(TIME_PI))/CONVERT(FLOAT,SUM(TC_PLAN)+SUM(TC_PI)),1)
		                              ELSE 0
		                         END TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(YYYYMM,1,4) AS YYYY
		                               , SUBSTRING(YYYYMM,5,2) AS MM
		                               , CMPNY_CD
		                               , TC_PLAN
		                               , TC_PI
		                               , TIME_PLAN
		                               , TIME_PI
		                          FROM TB_PERFOR_PLAN
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                       ) A
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT  CMPNY_CD
		                       , 'A' AS GBN
		                       , 0 AS TC_CNT
		                       , SUM(TC_PLAN) + SUM(TC_PI) AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(YYYYMM,5,2) AS MM
		                               , CMPNY_CD
		                               , TC_PLAN
		                               , TC_PI
		                               , TIME_PLAN
		                               , TIME_PI
		                          FROM TB_PERFOR_PLAN
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                        ) A
		                 WHERE 1 = 1
		                   AND MM = #{searchMonth}
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT  CMPNY_CD
		                       , 'B' AS GBN
		                       , 0 AS TC_CNT
		                       , SUM(TIME_PLAN) + SUM(TIME_PI) AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(YYYYMM,5,2) AS MM
		                               , CMPNY_CD
		                               , TC_PLAN
		                               , TC_PI
		                               , TIME_PLAN
		                               , TIME_PI
		                          FROM TB_PERFOR_PLAN
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                        ) A
		                 WHERE 1 = 1
		                   AND MM = #{searchMonth}
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT  CMPNY_CD
		                       , 'C' AS GBN
		                       , 0 AS TC_CNT
		                       , CASE WHEN SUM(TC_PLAN) + SUM(TC_PI) &gt; 0 AND SUM(TIME_PLAN) + SUM(TIME_PI) &gt; 0
		                              THEN ROUND(CONVERT(FLOAT,SUM(TIME_PLAN)+SUM(TIME_PI))/CONVERT(FLOAT,SUM(TC_PLAN)+SUM(TC_PI)),1)
		                              ELSE 0
		                         END AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(YYYYMM,5,2) AS MM
		                               , CMPNY_CD
		                               , TC_PLAN
		                               , TC_PI
		                               , TIME_PLAN
		                               , TIME_PI
		                          FROM TB_PERFOR_PLAN
		                         WHERE 1 = 1
		                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                       ) A
		                 WHERE 1 = 1
		                   AND MM = #{searchMonth}
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT   C.CMPNY_CD
		                       , 'A' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , SUM(C.TC_PI) AS  PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(A.YYYYMM,5,2) AS MM
		                               , A.CMPNY_CD
		                               , A.TC_PI
		                               , A.TIME_PI
		                          FROM TB_PERFOR A
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                        ) C
		                 WHERE 1 = 1
		                   AND MM = #{searchMonth}
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT   C.CMPNY_CD
		                       , 'B' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , SUM(C.TIME_PI) AS  PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(A.YYYYMM,5,2) AS MM
		                               , A.CMPNY_CD
		                               , A.TC_PI
		                               , A.TIME_PI
		                          FROM TB_PERFOR A
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                        ) C
		                 WHERE 1 = 1
		                   AND MM = #{searchMonth}
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		
		                SELECT   C.CMPNY_CD
		                       , 'C' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , CASE WHEN SUM(C.TC_PI) &gt; 0 AND SUM(C.TIME_PI) &gt; 0
		                              THEN ROUND(CONVERT(FLOAT,SUM(C.TIME_PI))/CONVERT(FLOAT,SUM(C.TC_PI)),1)
		                              ELSE 0
		                         END AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   SUBSTRING(A.YYYYMM,5,2) AS MM
		                               , A.CMPNY_CD
		                               , A.TC_PI
		                               , A.TIME_PI
		                          FROM TB_PERFOR A
		                         WHERE 1 = 1
		                           AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
		                        ) C
		                 WHERE 1 = 1
		                   AND MM = #{searchMonth}
		                 GROUP BY CMPNY_CD
		                
		                 UNION ALL
		                
		                SELECT   CMPNY_CD
		                       , 'A' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , COUNT(PROCESS_CD) AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , A.PROCESS_CD
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                       ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD = '0002'
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		      
		                SELECT   CMPNY_CD
		                       , 'B' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , ROUND(SUM(EXECUT_TM),1) AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
		                                      ELSE 0
		                                 END AS EXECUT_TM
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                       ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD = '0002'
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'C' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , CASE WHEN COUNT(PROCESS_CD) &gt; 0 AND ROUND(SUM(EXECUT_TM),1) &gt; 0
		                          THEN ROUND(CONVERT(FLOAT,SUM(EXECUT_TM))/CONVERT(FLOAT,COUNT(PROCESS_CD)),1)
		                          ELSE 0
		                         END AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , A.PROCESS_CD
		                               , CASE WHEN ISNULL(A.EXECUT_TM,0) &gt; 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
		                                      ELSE 0
		                                 END AS EXECUT_TM
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                        ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD = '0002'
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'A' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , COUNT(PROCESS_CD) AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , A.PROCESS_CD
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                        ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD = '0003'
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'B' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , ROUND(SUM(EXECUT_TM),1) AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
		                                      ELSE 0
		                                 END AS EXECUT_TM
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                        ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD = '0003'
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'C' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , CASE WHEN COUNT(PROCESS_CD) &gt; 0 AND ROUND(SUM(EXECUT_TM),1) &gt; 0
		                              THEN ROUND(CONVERT(FLOAT,SUM(EXECUT_TM))/CONVERT(FLOAT,COUNT(PROCESS_CD)),1)
		                              ELSE 0
		                         END AS PWU_CNT
		                       , 0 AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , A.PROCESS_CD
		                               , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
		                                      ELSE 0
		                                 END AS EXECUT_TM
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                       ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD = '0003'
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'A' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , COUNT(PROCESS_CD) AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , A.PROCESS_CD
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                        ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD NOT IN ('0002', '0003')
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'B' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , ROUND(SUM(EXECUT_TM),1) AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
		                                      ELSE 0
		                                 END AS EXECUT_TM
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                        ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD NOT IN ('0002', '0003')
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		
		                 UNION ALL
		
		                SELECT   CMPNY_CD
		                       , 'C' AS GBN
		                       , 0 AS TC_CNT
		                       , 0 AS MC_CNT
		                       , 0 AS PI_CNT
		                       , 0 AS SANG_CNT
		                       , 0 AS PWU_CNT
		                       , CASE WHEN COUNT(PROCESS_CD) &gt; 0 AND ROUND(SUM(EXECUT_TM),1) &gt; 0
		                              THEN ROUND(CONVERT(FLOAT,SUM(EXECUT_TM))/CONVERT(FLOAT,COUNT(PROCESS_CD)),1)
		                              ELSE 0
		                         END AS OUT_CNT
		                  FROM (
		                        SELECT   A.CMPNY_CD
		                               , A.PROCESS_CD
		                               , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
		                                      ELSE 0
		                                 END AS EXECUT_TM
		                               , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
		                               , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
		                               , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
		                          FROM TB_TASK_DEVLOP_PROCESS A
		                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
		                               LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
		                               LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
		                         WHERE 1 = 1
		                           AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) = CONCAT( #{searchYear},'-',#{searchMonth})
		                           AND A.PROCESS_STTUS IN ('D4', 'O1')
		                       ) E
		                 WHERE 1 = 1
		                   AND ROLE_CD NOT IN ('0002', '0003')
		                 GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
		                ) X
		                LEFT OUTER JOIN TB_CMMN_CD Y ON Y.CLS_CD = '0024' AND Y.USE_AT = 'Y' AND X.CMPNY_CD =Y.CD
		          WHERE 1 = 1
		          GROUP BY CMPNY_CD, GBN, Y.CD_NM
		        ) Z
		 WHERE 1 = 1
		 ORDER BY CMPNY_CD, GBN
    </select>
        
    <select id="selectPlanAgainstPerforStatusTwoList" parameterType="java.util.Map" resultType="camelMap">
        /* ExecutStatsMapper.selectPlanAgainstPerforStatusTwoList */
        SELECT   CMPNY_CD
               , CMPNY_NM
               , GBN
               , TC_CNT
               , MC_CNT
               , ROUND(PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT,1)  AS SUM_NO1
               , PI_CNT
               , ROUND(SANG_CNT+PWU_CNT+OUT_CNT,1) AS SUM_NO2
               , SANG_CNT
               , PWU_CNT
               , OUT_CNT
               , CASE WHEN GBN = 'A' THEN  ROUND(PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT - MC_CNT,1)
                      WHEN GBN = 'B' THEN  ROUND(PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT - MC_CNT,1)
                      ELSE 0
                 END AS DIF_CNT
               , CASE WHEN GBN = 'A' THEN  
                                          CASE WHEN MC_CNT > 0 THEN ROUND( ( PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT ) / MC_CNT *100,1) 
                                               ELSE 0
                                           END
                      WHEN GBN = 'B' THEN  
                                          CASE WHEN MC_CNT > 0 THEN ROUND( ( PI_CNT+SANG_CNT+PWU_CNT+OUT_CNT ) / MC_CNT *100,1) 
                                               ELSE 0
                                           END
                      ELSE 0
                 END AS SUC_PER
          FROM (
                SELECT   CMPNY_CD
                       , Y.CD_NM AS CMPNY_NM
                       , GBN
                       , SUM(TC_CNT) AS TC_CNT
                       , SUM(MC_CNT) AS MC_CNT
                       , SUM(PI_CNT) AS PI_CNT
                       , SUM(SANG_CNT) AS SANG_CNT
                       , SUM(PWU_CNT) AS PWU_CNT
                       , SUM(OUT_CNT) AS OUT_CNT
                  FROM (
                        SELECT   CMPNY_CD
                               , 'A' AS GBN
                               , SUM(TC_PLAN) + SUM(TC_PI) AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(YYYYMM,1,4) AS YYYY
                                       , SUBSTRING(YYYYMM,5,2) AS MM
                                       , CMPNY_CD
                                       , TC_PLAN
                                       , TC_PI
                                       , TIME_PLAN
                                       , TIME_PI
                                  FROM TB_PERFOR_PLAN
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                                ) A
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'B' AS GBN
                               , SUM(TIME_PLAN) + SUM(TIME_PI) AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(YYYYMM,1,4) AS YYYY
                                       , SUBSTRING(YYYYMM,5,2) AS MM
                                       , CMPNY_CD
                                       , TC_PLAN
                                       , TC_PI
                                       , TIME_PLAN
                                       , TIME_PI
                                  FROM TB_PERFOR_PLAN
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                                ) A
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT  CMPNY_CD
                               , 'C' AS GBN
                               , CASE WHEN SUM(TC_PLAN) + SUM(TC_PI) &gt; 0 AND SUM(TIME_PLAN) + SUM(TIME_PI) &gt; 0
                                      THEN ROUND(CONVERT(FLOAT,SUM(TIME_PLAN)+SUM(TIME_PI))/CONVERT(FLOAT,SUM(TC_PLAN)+SUM(TC_PI)),1)
                                      ELSE 0
                                 END TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(YYYYMM,1,4) AS YYYY
                                       , SUBSTRING(YYYYMM,5,2) AS MM
                                       , CMPNY_CD
                                       , TC_PLAN
                                       , TC_PI
                                       , TIME_PLAN
                                       , TIME_PI
                                  FROM TB_PERFOR_PLAN
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                               ) A
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT  CMPNY_CD
                               , 'A' AS GBN
                               , 0 AS TC_CNT
                               , SUM(TC_PLAN) + SUM(TC_PI) AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(YYYYMM,5,2) AS MM
                                       , CMPNY_CD
                                       , TC_PLAN
                                       , TC_PI
                                       , TIME_PLAN
                                       , TIME_PI
                                  FROM TB_PERFOR_PLAN
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                                ) A
                         WHERE 1 = 1
                           AND MM BETWEEN '01' AND #{searchMonth}
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT  CMPNY_CD
                               , 'B' AS GBN
                               , 0 AS TC_CNT
                               , SUM(TIME_PLAN) + SUM(TIME_PI) AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(YYYYMM,5,2) AS MM
                                       , CMPNY_CD
                                       , TC_PLAN
                                       , TC_PI
                                       , TIME_PLAN
                                       , TIME_PI
                                  FROM TB_PERFOR_PLAN
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                                ) A
                         WHERE 1 = 1
                           AND MM BETWEEN '01' AND #{searchMonth}
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT  CMPNY_CD
                               , 'C' AS GBN
                               , 0 AS TC_CNT
                               , CASE WHEN SUM(TC_PLAN) + SUM(TC_PI) &gt; 0 AND SUM(TIME_PLAN) + SUM(TIME_PI) &gt; 0
                                      THEN ROUND(CONVERT(FLOAT,SUM(TIME_PLAN)+SUM(TIME_PI))/CONVERT(FLOAT,SUM(TC_PLAN)+SUM(TC_PI)),1)
                                      ELSE 0
                                 END AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(YYYYMM,5,2) AS MM
                                       , CMPNY_CD
                                       , TC_PLAN
                                       , TC_PI
                                       , TIME_PLAN
                                       , TIME_PI
                                  FROM TB_PERFOR_PLAN
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                               ) A
                         WHERE 1 = 1
                           AND MM BETWEEN '01' AND #{searchMonth}
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT   C.CMPNY_CD
                               , 'A' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , SUM(C.TC_PI) AS  PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(A.YYYYMM,5,2) AS MM
                                       , A.CMPNY_CD
                                       , A.TC_PI
                                       , A.TIME_PI
                                  FROM TB_PERFOR A
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                                ) C
                         WHERE 1 = 1
                           AND MM BETWEEN '01' AND #{searchMonth}
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT   C.CMPNY_CD
                               , 'B' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , SUM(C.TIME_PI) AS  PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(A.YYYYMM,5,2) AS MM
                                       , A.CMPNY_CD
                                       , A.TC_PI
                                       , A.TIME_PI
                                  FROM TB_PERFOR A
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                                ) C
                         WHERE 1 = 1
                           AND MM BETWEEN '01' AND #{searchMonth}
                         GROUP BY CMPNY_CD
        
                         UNION ALL
        
                        SELECT   C.CMPNY_CD
                               , 'C' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , CASE WHEN SUM(C.TC_PI) &gt; 0 AND SUM(C.TIME_PI) &gt; 0
                                      THEN ROUND(CONVERT(FLOAT,SUM(C.TIME_PI))/CONVERT(FLOAT,SUM(C.TC_PI)),1)
                                      ELSE 0
                                 END AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   SUBSTRING(A.YYYYMM,5,2) AS MM
                                       , A.CMPNY_CD
                                       , A.TC_PI
                                       , A.TIME_PI
                                  FROM TB_PERFOR A
                                 WHERE 1 = 1
                                   AND SUBSTRING(YYYYMM,1,4) = #{searchYear}
                                ) C
                         WHERE 1 = 1
                           AND MM BETWEEN '01' AND #{searchMonth}
                         GROUP BY CMPNY_CD
                        
                         UNION ALL
                        
                        SELECT   CMPNY_CD
                               , 'A' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , COUNT(PROCESS_CD) AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , A.PROCESS_CD
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                               ) E
                         WHERE 1 = 1
                           AND ROLE_CD = '0002'
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
              
                        SELECT   CMPNY_CD
                               , 'B' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , ROUND(SUM(EXECUT_TM),1) AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
                                              ELSE 0
                                         END AS EXECUT_TM
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                               ) E
                         WHERE 1 = 1
                           AND ROLE_CD = '0002'
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'C' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , CASE WHEN COUNT(PROCESS_CD) &gt; 0 AND ROUND(SUM(EXECUT_TM),1) &gt; 0
                                  THEN ROUND(CONVERT(FLOAT,SUM(EXECUT_TM))/CONVERT(FLOAT,COUNT(PROCESS_CD)),1)
                                  ELSE 0
                                 END AS SANG_CNT
                               , 0 AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , A.PROCESS_CD
                                       , CASE WHEN ISNULL(A.EXECUT_TM,0) &gt; 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
                                              ELSE 0
                                         END AS EXECUT_TM
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                                ) E
                         WHERE 1 = 1
                           AND ROLE_CD = '0002'
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'A' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , COUNT(PROCESS_CD) AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , A.PROCESS_CD
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                                ) E
                         WHERE 1 = 1
                           AND ROLE_CD = '0003'
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'B' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , ROUND(SUM(EXECUT_TM),1) AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
                                              ELSE 0
                                         END AS EXECUT_TM
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                                ) E
                         WHERE 1 = 1
                           AND ROLE_CD = '0003'
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'C' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , CASE WHEN COUNT(PROCESS_CD) &gt; 0 AND ROUND(SUM(EXECUT_TM),1) &gt; 0
                                      THEN ROUND(CONVERT(FLOAT,SUM(EXECUT_TM))/CONVERT(FLOAT,COUNT(PROCESS_CD)),1)
                                      ELSE 0
                                 END AS PWU_CNT
                               , 0 AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , A.PROCESS_CD
                                       , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
                                              ELSE 0
                                         END AS EXECUT_TM
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                               ) E
                         WHERE 1 = 1
                           AND ROLE_CD = '0003'
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'A' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , COUNT(PROCESS_CD) AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , A.PROCESS_CD
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                                ) E
                         WHERE 1 = 1
                           AND ROLE_CD NOT IN ('0002', '0003')
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'B' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , ROUND(SUM(EXECUT_TM),1) AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
                                              ELSE 0
                                         END AS EXECUT_TM
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                                ) E
                         WHERE 1 = 1
                           AND ROLE_CD NOT IN ('0002', '0003')
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
        
                         UNION ALL
        
                        SELECT   CMPNY_CD
                               , 'C' AS GBN
                               , 0 AS TC_CNT
                               , 0 AS MC_CNT
                               , 0 AS PI_CNT
                               , 0 AS SANG_CNT
                               , 0 AS PWU_CNT
                               , CASE WHEN COUNT(PROCESS_CD) &gt; 0 AND ROUND(SUM(EXECUT_TM),1) &gt; 0
                                      THEN ROUND(CONVERT(FLOAT,SUM(EXECUT_TM))/CONVERT(FLOAT,COUNT(PROCESS_CD)),1)
                                      ELSE 0
                                 END AS OUT_CNT
                          FROM (
                                SELECT   A.CMPNY_CD
                                       , A.PROCESS_CD
                                       , CASE WHEN ISNULL(A.EXECUT_TM,0) > 0 THEN CONVERT(float, A.EXECUT_TM/12 * CONVERT(INT,'02'))
                                              ELSE 0
                                         END AS EXECUT_TM
                                       , ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) AS YYYYMM
                                       , ISNULL(C.ROLE_CD,'-') AS ROLE_CD
                                       , ISNULL(D.ROLE_NM,'-') AS ROLE_NM
                                  FROM TB_TASK_DEVLOP_PROCESS A
                                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0024' AND B.USE_AT = 'Y' AND A.CMPNY_CD =B.CD
                                       LEFT OUTER JOIN TB_USER_ROLE C ON A.REGISTER_ID = C.USER_ID
                                       LEFT OUTER JOIN TB_ROLE D ON C.ROLE_CD = D.ROLE_CD
                                 WHERE 1 = 1
                                   AND ISNULL( CONVERT(CHAR(7), A.BELONGING_DE, 23), CONVERT(CHAR(7), A.REG_DT, 23)) BETWEEN CONCAT( #{searchYear},'-','01') AND CONCAT( #{searchYear},'-',#{searchMonth})
                                   AND A.PROCESS_STTUS IN ('D4', 'O1')
                               ) E
                         WHERE 1 = 1
                           AND ROLE_CD NOT IN ('0002', '0003')
                         GROUP BY CMPNY_CD, YYYYMM, ROLE_CD, ROLE_NM
                        ) X
                        LEFT OUTER JOIN TB_CMMN_CD Y ON Y.CLS_CD = '0024' AND Y.USE_AT = 'Y' AND X.CMPNY_CD =Y.CD
                  WHERE 1 = 1
                  GROUP BY CMPNY_CD, GBN, Y.CD_NM
                ) Z
         WHERE 1 = 1
         ORDER BY CMPNY_CD, GBN
    </select>
        
    <select id="selectPreocessOperStatusList" parameterType="java.util.Map" resultType="camelMap">
        /* ExecutStatsMapper.selectPreocessOperStatusList */
		SELECT   CMPNY_CD
		       , CMPNY_NM
		       , DEV_CNT
		       , PRC_CNT
		       , PRC_RUN_CNT
		       , RUN_CNT
		       , SOL_CNT
		       , SOL_PRC_CNT
		       , SUC_CNT
		       , SUC_PER
		       , ROUND(SUC_PER - 97,2) AS TG_VS
		  FROM (
		        SELECT   Z.CMPNY_CD
		               , Y.CD_NM AS CMPNY_NM
		               , SUM(DEV_CNT) AS DEV_CNT
		               , SUM(PRC_CNT) AS PRC_CNT
		               , SUM(PRC_RUN_CNT) AS PRC_RUN_CNT
		               , SUM(RUN_CNT) AS RUN_CNT
		               , SUM(SOL_CNT) AS SOL_CNT
		               , SUM(SOL_PRC_CNT) AS SOL_PRC_CNT
		               , SUM(SUC_CNT) AS SUC_CNT
		               , CASE WHEN SUM(RUN_CNT) > 0 AND SUM(SUC_CNT) > 0 
		                      THEN ROUND(CONVERT(FLOAT,SUM(SUC_CNT))/CONVERT(FLOAT,SUM(RUN_CNT)) * 100,2)
		                      ELSE 0
		                 END SUC_PER
		          FROM (
		                -- 개발 완료
		                SELECT   CMPNY_CD
		                       , COUNT(*) AS DEV_CNT
		                       , 0 AS PRC_CNT
		                       , 0 AS PRC_RUN_CNT
		                       , 0 AS RUN_CNT
		                       , 0 AS SOL_CNT
		                       , 0 AS SOL_PRC_CNT
		                       , 0 AS SUC_CNT
		                  FROM TB_TASK_DEVLOP_PROCESS A
		                 WHERE 1 = 1
		                   AND ISNULL( CONVERT(DATETIME, A.BELONGING_DE), CONVERT(DATETIME, A.REG_DT))  BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
		                   AND PROCESS_STTUS IN ('D4', 'O1')
		                 GROUP BY CMPNY_CD
		
		                 UNION ALL
		                -- 프로세스 갯수
		                SELECT   COMP_CD
		                       , 0 AS DEV_CNT
		                       , COUNT(*) AS PRC_CNT
		                       , 0 AS PRC_RUN_CNT
		                       , 0 AS RUN_CNT
		                       , 0 AS SOL_CNT
		                       , 0 AS SOL_PRC_CNT
		                       , 0 AS SUC_CNT
		                  FROM (
		                        SELECT   COMP_CD
		                               , PROCESS_CD
		                          FROM TB_STS_TOT
		                         WHERE 1 = 1
		                           AND START_TIME BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
		                         GROUP BY COMP_CD, PROCESS_CD
		                       ) A
		                 GROUP BY COMP_CD
		
		                 UNION ALL
		                -- 프로세스 실행횟수
		                SELECT   COMP_CD
		                       , 0 AS DEV_CNT
		                       , 0 AS PRC_CNT
		                       , COUNT(*) AS PRC_RUN_CNT
		                       , 0 AS RUN_CNT
		                       , 0 AS SOL_CNT
		                       , 0 AS SOL_PRC_CNT
		                       , 0 AS SUC_CNT
		                  FROM TB_STS_TOT
		                 WHERE 1 = 1
		                   AND START_TIME BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
		                 GROUP BY COMP_CD
		
		                 UNION ALL
		
		                -- TR 실행 횟수
		                SELECT   B.CD_NM AS CMPNY_CD
		                       , 0 AS DEV_CNT
		                       , 0 AS PRC_CNT
		                       , 0 AS PRC_RUN_CNT
		                       , COUNT(A.ID) AS RUN_CNT
		                       , 0 AS SOL_CNT
		                       , 0 AS SOL_PRC_CNT
		                       , 0 AS SUC_CNT
		                  FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
		                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
		                 WHERE 1 = 1 
		                   AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
		                   AND A.LOG_SE = 'T'
		                 GROUP BY B.CD_NM
		
		                 UNION ALL
		
		                -- 조치횟수
		                SELECT   B.CMPNY_CD
		                       , 0 AS DEV_CNT
		                       , 0 AS PRC_CNT
		                       , 0 AS PRC_RUN_CNT
		                       , 0 AS RUN_CNT
		                       , ISNULL(SUM(ERROR_UNITY_CNT), 0) AS SOL_CNT
		                       , 0 AS SOL_PRC_CNT
		                       , 0 AS SUC_CNT
		                  FROM   TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
		                       , TB_TRNSC_ERROR B
		                 WHERE 1 = 1
		                   AND A.ID = B.SN 
		                   AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
		                   AND A.LOG_SE = 'T'
		                   AND B.ERROR_UNITY_SN IS NULL
		                   AND B.STTUS_CD = '03'
		                 GROUP BY B.CMPNY_CD
		
		                 UNION ALL
		
		                -- 조치한 프로세스수
		                SELECT   B.CMPNY_CD
		                       , 0 AS DEV_CNT
		                       , 0 AS PRC_CNT
		                       , 0 AS PRC_RUN_CNT
		                       , 0 AS RUN_CNT
		                       , 0 AS SOL_CNT
		                       , COUNT(DISTINCT A.JOB_ID) AS SOL_PRC_CNT
		                       , 0 AS SUC_CNT
		                  FROM   TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
		                       , TB_TRNSC_ERROR B
		                 WHERE 1 = 1
		                   AND A.ID = B.SN
		                   AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
		                   AND A.LOG_SE = 'T'
		                   AND B.ERROR_UNITY_SN IS NULL
		                   AND B.STTUS_CD = '03'
		                 GROUP BY B.CMPNY_CD
		
		                 UNION ALL
		
		                -- 성공횟수
		                SELECT   B.CD_NM AS CMPNY_CD
		                       , 0 AS DEV_CNT
		                       , 0 AS PRC_CNT
		                       , 0 AS PRC_RUN_CNT
		                       , 0 AS RUN_CNT
		                       , 0 AS SOL_CNT
		                       , 0 AS SOL_PRC_CNT
		                       , COUNT(A.ID) AS SUC_CNT
		                  FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
		                       LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
		                 WHERE 1 = 1
		                   AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
		                   AND A.LOG_SE = 'T'
		                   AND A.TRNSC_STATS = 'Success'
		                 GROUP BY B.CD_NM
		                 
		                 UNION ALL
		
		                SELECT   CD AS CMPNY_CD
		                        , 0 AS DEV_CNT
		                        , 0 AS PRC_CNT
		                        , 0 AS PRC_RUN_CNT
		                        , 0 AS RUN_CNT
		                        , 0 AS SOL_CNT
		                        , 0 AS SOL_PRC_CNT
		                        , 0 AS SUC_CNT
		                    FROM TB_CMMN_CD
		                   WHERE 1 = 1 
		                     AND CLS_CD = '0024' 
		                     AND USE_AT = 'Y' 
		               ) Z
		               LEFT OUTER JOIN TB_CMMN_CD Y ON Y.CLS_CD = '0024' AND Y.USE_AT = 'Y' AND Z.CMPNY_CD =Y.CD
		         WHERE 1 = 1
		         GROUP BY CMPNY_CD, Y.CD_NM
		       ) X
		 WHERE 1 = 1
		 ORDER BY CMPNY_CD
    </select>
    
        
    <select id="selectPreocessOperStatusTotList" parameterType="java.util.Map" resultType="camelMap">
        /* ExecutStatsMapper.selectPreocessOperStatusTotList */
        SELECT   DEV_CNT
               , PRC_CNT
               , PRC_RUN_CNT
               , RUN_CNT
               , SOL_CNT
               , SOL_PRC_CNT
               , SUC_CNT
               , SUC_PER
               , ROUND(SUC_PER - 97,2) AS TG_VS
          FROM (
                SELECT   SUM(DEV_CNT) AS DEV_CNT
                       , SUM(PRC_CNT) AS PRC_CNT
                       , SUM(PRC_RUN_CNT) AS PRC_RUN_CNT
                       , SUM(RUN_CNT) AS RUN_CNT
                       , SUM(SOL_CNT) AS SOL_CNT
                       , SUM(SOL_PRC_CNT) AS SOL_PRC_CNT
                       , SUM(SUC_CNT) AS SUC_CNT
                       , CASE WHEN SUM(RUN_CNT) > 0 AND SUM(SUC_CNT) > 0 
                              THEN ROUND(CONVERT(FLOAT,SUM(SUC_CNT))/CONVERT(FLOAT,SUM(RUN_CNT)) * 100,2)
                              ELSE 0
                         END SUC_PER
                  FROM (
                        -- 개발 완료
                        SELECT   COUNT(*) AS DEV_CNT
                               , 0 AS PRC_CNT
                               , 0 AS PRC_RUN_CNT
                               , 0 AS RUN_CNT
                               , 0 AS SOL_CNT
                               , 0 AS SOL_PRC_CNT
                               , 0 AS SUC_CNT
                          FROM TB_TASK_DEVLOP_PROCESS A
                         WHERE 1 = 1
                           AND ISNULL( CONVERT(DATETIME, A.BELONGING_DE), CONVERT(DATETIME, A.REG_DT))  BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                           AND PROCESS_STTUS IN ('D4', 'O1')
        
                         UNION ALL
                        -- 프로세스 갯수
                        SELECT   0 AS DEV_CNT
                               , COUNT(*) AS PRC_CNT
                               , 0 AS PRC_RUN_CNT
                               , 0 AS RUN_CNT
                               , 0 AS SOL_CNT
                               , 0 AS SOL_PRC_CNT
                               , 0 AS SUC_CNT
                          FROM (
                                SELECT   COMP_CD
                                       , PROCESS_CD
                                  FROM TB_STS_TOT
                                 WHERE 1 = 1
                                   AND START_TIME BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                                 GROUP BY COMP_CD, PROCESS_CD
                               ) A
                         WHERE 1 = 1
        
                         UNION ALL
                        -- 프로세스 실행횟수
                        SELECT   0 AS DEV_CNT
                               , 0 AS PRC_CNT
                               , COUNT(*) AS PRC_RUN_CNT
                               , 0 AS RUN_CNT
                               , 0 AS SOL_CNT
                               , 0 AS SOL_PRC_CNT
                               , 0 AS SUC_CNT
                          FROM TB_STS_TOT
                         WHERE 1 = 1
                           AND START_TIME BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
        
                         UNION ALL
        
                        -- TR 실행 횟수
                        SELECT   0 AS DEV_CNT
                               , 0 AS PRC_CNT
                               , 0 AS PRC_RUN_CNT
                               , COUNT(A.ID) AS RUN_CNT
                               , 0 AS SOL_CNT
                               , 0 AS SOL_PRC_CNT
                               , 0 AS SUC_CNT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                         WHERE 1 = 1 
                           AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                           AND A.LOG_SE = 'T'
        
                         UNION ALL
        
                        -- 조치횟수
                        SELECT   0 AS DEV_CNT
                               , 0 AS PRC_CNT
                               , 0 AS PRC_RUN_CNT
                               , 0 AS RUN_CNT
                               , ISNULL(SUM(ERROR_UNITY_CNT), 0) AS SOL_CNT
                               , 0 AS SOL_PRC_CNT
                               , 0 AS SUC_CNT
                          FROM   TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               , TB_TRNSC_ERROR B
                         WHERE 1 = 1
                           AND A.ID = B.SN 
                           AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                           AND A.LOG_SE = 'T'
                           AND B.ERROR_UNITY_SN IS NULL
                           AND B.STTUS_CD = '03'
        
                         UNION ALL
        
                        -- 조치한 프로세스수
                        SELECT   0 AS DEV_CNT
                               , 0 AS PRC_CNT
                               , 0 AS PRC_RUN_CNT
                               , 0 AS RUN_CNT
                               , 0 AS SOL_CNT
                               , COUNT(DISTINCT A.JOB_ID) AS SOL_PRC_CNT
                               , 0 AS SUC_CNT
                          FROM   TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               , TB_TRNSC_ERROR B
                         WHERE 1 = 1
                           AND A.ID = B.SN
                           AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                           AND A.LOG_SE = 'T'
                           AND B.ERROR_UNITY_SN IS NULL
                           AND B.STTUS_CD = '03'
        
                         UNION ALL
        
                        -- 성공횟수
                        SELECT   0 AS DEV_CNT
                               , 0 AS PRC_CNT
                               , 0 AS PRC_RUN_CNT
                               , 0 AS RUN_CNT
                               , 0 AS SOL_CNT
                               , 0 AS SOL_PRC_CNT
                               , COUNT(A.ID) AS SUC_CNT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                         WHERE 1 = 1
                           AND A.TIMESTAMP BETWEEN DATEADD(HH, -9, CONVERT(DATETIME, #{startDe})) AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                           AND A.LOG_SE = 'T'
                           AND A.TRNSC_STATS = 'Success'
                         
                         UNION ALL
        
                        SELECT   0 AS DEV_CNT
                               , 0 AS PRC_CNT
                               , 0 AS PRC_RUN_CNT
                               , 0 AS RUN_CNT
                               , 0 AS SOL_CNT
                               , 0 AS SOL_PRC_CNT
                               , 0 AS SUC_CNT
                           FROM TB_CMMN_CD
                          WHERE 1 = 1 
                            AND CLS_CD = '0024' 
                            AND USE_AT = 'Y' 
                       ) Z
                 WHERE 1 = 1
               ) X
         WHERE 1 = 1
    </select>
    
    <select id="selectPreocessOperStatusChart" parameterType="java.util.Map" resultType="camelMap">
        /* ExecutStatsMapper.selectPreocessOperStatusChart */
        SELECT   CMPNY_CD
               , Y.CD_NM AS CMPNY_NM 
               , WK_SUC_PER
               , WWK_SUC_PER
               , WWWK_SUC_PER
               , WWWWK_SUC_PER
          FROM (
                SELECT   CMPNY_CD
                       , SUM(W1_RUN_CNT) AS W1_RUN_CNT
                       , SUM(W1_SUC_CNT) AS W1_SUC_CNT
                       , CASE WHEN SUM(W1_RUN_CNT) > 0 AND SUM(W1_SUC_CNT) > 0 
                              THEN ROUND(CONVERT(FLOAT,SUM(W1_SUC_CNT))/CONVERT(FLOAT,SUM(W1_RUN_CNT)) * 100,2)
                              ELSE 0
                         END AS WK_SUC_PER
                       , SUM(W2_RUN_CNT) AS W2_RUN_CNT
                       , SUM(W2_SUC_CNT) AS W2_SUC_CNT
                       , CASE WHEN SUM(W2_RUN_CNT) > 0 AND SUM(W2_SUC_CNT) > 0 
                              THEN ROUND(CONVERT(FLOAT,SUM(W2_SUC_CNT))/CONVERT(FLOAT,SUM(W2_RUN_CNT)) * 100,2)
                              ELSE 0
                         END AS WWK_SUC_PER
                       , SUM(W3_RUN_CNT) AS W3_RUN_CNT
                       , SUM(W3_SUC_CNT) AS W3_SUC_CNT
                       , CASE WHEN SUM(W3_RUN_CNT) > 0 AND SUM(W3_SUC_CNT) > 0 
                              THEN ROUND(CONVERT(FLOAT,SUM(W3_SUC_CNT))/CONVERT(FLOAT,SUM(W3_RUN_CNT)) * 100,2)
                              ELSE 0
                         END AS WWWK_SUC_PER
                       , SUM(W4_RUN_CNT) AS W4_RUN_CNT
                       , SUM(W4_SUC_CNT) AS W4_SUC_CNT
                       , CASE WHEN SUM(W4_RUN_CNT) > 0 AND SUM(W4_SUC_CNT) > 0 
                              THEN ROUND(CONVERT(FLOAT,SUM(W4_SUC_CNT))/CONVERT(FLOAT,SUM(W4_RUN_CNT)) * 100,2)
                              ELSE 0
                         END AS WWWWK_SUC_PER
                  FROM (
                        SELECT   B.CD_NM AS CMPNY_CD
                               , COUNT(A.ID) AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                         WHERE 1 = 1 
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -28, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(MINUTE, -1, DATEADD(DD, -21, CONVERT(DATETIME, DATEADD(HH, 15, CONVERT(DATETIME, #{endDe})))))
                           AND A.LOG_SE = 'T'
                         GROUP BY B.CD_NM

                         UNION ALL

                        SELECT   B.CD_NM AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , COUNT(A.ID) AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNTT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                          WHERE 1 = 1
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -28, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(MINUTE, -1, DATEADD(DD, -21, CONVERT(DATETIME, DATEADD(HH, 15, CONVERT(DATETIME, #{endDe})))))
                           AND A.LOG_SE = 'T'
                           AND A.TRNSC_STATS = 'Success'
                         GROUP BY B.CD_NM

                         UNION ALL

                        SELECT   B.CD_NM AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , COUNT(A.ID) AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNTT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                         WHERE 1 = 1 
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -21, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(MINUTE, -1, DATEADD(DD, -14, CONVERT(DATETIME, DATEADD(HH, 15, CONVERT(DATETIME, #{endDe})))))
                           AND A.LOG_SE = 'T'
                         GROUP BY B.CD_NM

                         UNION ALL

                        SELECT   B.CD_NM AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , COUNT(A.ID) AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNTT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                         WHERE 1 = 1
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -21, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(MINUTE, -1, DATEADD(DD, -14, CONVERT(DATETIME, DATEADD(HH, 15, CONVERT(DATETIME, #{endDe})))))
                           AND A.LOG_SE = 'T'
                           AND A.TRNSC_STATS = 'Success'
                         GROUP BY B.CD_NM

                         UNION ALL

                        SELECT   B.CD_NM AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , COUNT(A.ID) AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNTT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                         WHERE 1 = 1 
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -14, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(MINUTE, -1, DATEADD(DD, -7, CONVERT(DATETIME, DATEADD(HH, 15, CONVERT(DATETIME, #{endDe})))))
                           AND A.LOG_SE = 'T'
                         GROUP BY B.CD_NM

                         UNION ALL

                        SELECT   B.CD_NM AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , COUNT(A.ID) AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNTT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                         WHERE 1 = 1
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -14, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(MINUTE, -1, DATEADD(DD, -7, CONVERT(DATETIME, DATEADD(HH, 15, CONVERT(DATETIME, #{endDe})))))
                           AND A.LOG_SE = 'T'
                           AND A.TRNSC_STATS = 'Success'
                         GROUP BY B.CD_NM

                         UNION ALL

                        SELECT   B.CD_NM AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , COUNT(A.ID) AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNTT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                               LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                         WHERE 1 = 1
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -7, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                           AND A.LOG_SE = 'T'
                         GROUP BY B.CD_NM

                         UNION ALL

                        SELECT   B.CD_NM AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , COUNT(A.ID) AS W4_SUC_CNTT
                          FROM TB_TRNSC_RPA_LOG A WITH(INDEX(TB_TRNSC_RPA_LOG_TimeStamp_IDX))
                                   LEFT OUTER JOIN TB_CMMN_CD B ON B.CLS_CD = '0034' AND B.USE_AT = 'Y' AND A.TenantId =B.CD
                         WHERE 1 = 1
                           AND A.TIMESTAMP BETWEEN DATEADD(DD, -7, CONVERT(DATETIME, DATEADD(HH, -9, CONVERT(DATETIME, #{endDe}))))
                                               AND DATEADD(HH, 15, CONVERT(DATETIME, #{endDe}))
                           AND A.LOG_SE = 'T'
                           AND A.TRNSC_STATS = 'Success'
                         GROUP BY B.CD_NM
                         
                         UNION ALL

                        SELECT   CD AS CMPNY_CD
                               , 0 AS W1_RUN_CNT
                               , 0 AS W1_SUC_CNT
                               , 0 AS W2_RUN_CNT
                               , 0 AS W2_SUC_CNT
                               , 0 AS W3_RUN_CNT
                               , 0 AS W3_SUC_CNT
                               , 0 AS W4_RUN_CNT
                               , 0 AS W4_SUC_CNT
                           FROM TB_CMMN_CD
                          WHERE 1 = 1 
                            AND CLS_CD = '0024' 
                            AND USE_AT = 'Y' 
                        ) X
                  WHERE 1 = 1
                  GROUP BY CMPNY_CD
               ) Z
               LEFT OUTER JOIN TB_CMMN_CD Y ON Y.CLS_CD = '0024' AND Y.USE_AT = 'Y' AND Z.CMPNY_CD =Y.CD
         WHERE 1 = 1
         ORDER BY CMPNY_CD
    </select>
    
	<select id="selectProcessMonthListV2" parameterType="java.util.Map" resultType="camelMap">
	/* TaskManageMapper.selectProcessMonthListV2 */
	SET ANSI_WARNINGS OFF
SET ARITHIGNORE ON
SET ARITHABORT OFF

	SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
			, SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
			, SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
			, SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
			, SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
			, SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
			, SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
			, SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT
	FROM (
		-- A 통계
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
					        FROM (
					        
					        	SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , SUESS_CNT
					                FROM TB_STS_PROC A
									INNER JOIN TB_TASK_DEVLOP_PROCESS B
									ON A.PROCESS_CD = B.PROCESS_CD
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
					                -- 실행구분
					                AND B.EXECUT_SE IS NULL
					                
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
			                        
			                    UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , SUESS_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY )
	
									UNION ALL
									-- 재실행 데이터 반영
									SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , SUESS_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
									
									UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , SUESS_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY )
	
									UNION ALL
									-- 재실행 데이터 반영
									SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , SUESS_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
					    )  AS result
					PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- B 통계
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
					        FROM (
					        	SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , FAIL_CNT
					                FROM TB_STS_PROC A
									INNER JOIN TB_TASK_DEVLOP_PROCESS B
									ON A.PROCESS_CD = B.PROCESS_CD
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
					                -- 실행구분
					                AND B.EXECUT_SE IS NULL
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
			                        
			                    UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , FAIL_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , FAIL_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
									
								UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , FAIL_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , FAIL_CNT
					                FROM TB_STS_PROC A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
					    )  AS result
				PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- C(DAY) 통계
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				, ISNULL(D31,0) AS D31, 0 AS MON_TOT
			FROM (
				SELECT   YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
					    , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
					FROM (
						SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.PROCESS_CD
					            , A.PROCESS_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_PROC A
					        INNER JOIN TB_TASK_DEVLOP_PROCESS B
					        ON A.PROCESS_CD = B.PROCESS_CD
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
					        -- 실행구분
					        AND B.EXECUT_SE IS NULL
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
			                
			            UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.PROCESS_CD
					            , A.PROCESS_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.PROCESS_CD
					            , A.PROCESS_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
							
							UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.PROCESS_CD
					            , A.PROCESS_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.PROCESS_CD
					            , A.PROCESS_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					    ) S
					WHERE 1 = 1
					GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
				)  AS result
		PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	
		UNION ALL
	
		-- C (TOTAL) 통계
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
				, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
				, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
				, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
				, SUM(MON_TOT) AS MON_TOT
		FROM (
			SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
			FROM (
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.PROCESS_CD
					        , A.PROCESS_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_PROC A
					    INNER JOIN TB_TASK_DEVLOP_PROCESS B
					    ON A.PROCESS_CD = B.PROCESS_CD
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
					    -- 실행구분
					    AND B.EXECUT_SE IS NULL
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
			            
			        UNION ALL
			        
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.PROCESS_CD
					        , A.PROCESS_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_PROC A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.PROCESS_CD
					        , A.PROCESS_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_PROC A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
					
					UNION ALL
			        
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.PROCESS_CD
					        , A.PROCESS_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_PROC A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.PROCESS_CD
					        , A.PROCESS_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_PROC A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					) S
			WHERE 1 = 1
			GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
	
			UNION ALL
			--   C 합계
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'A' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, 0 AS MON_TOT
			FROM TB_STS_PROC
			WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'B' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, 0 AS MON_TOT
			FROM TB_STS_PROC
			WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, 0 AS MON_TOT
			FROM TB_STS_PROC
			WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
			) T
		WHERE 1= 1
		GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
	
		UNION ALL
	
		-- D 평균실행시간
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, ROUND(CONVERT(FLOAT , (D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31)) / EXECUT_CNT , 2) AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN , EXECUT_CNT
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, AVG(EXECUT_TM) AS EXECUT_TM , 'D' AS GBN , EXECUT_CNT
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.PROCESS_CD
					                    , A.PROCESS_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS EXECUT_TM
										, ( SELECT COUNT(DISTINCT(YMD)) FROM TB_STS_PROC B WHERE B.PROCESS_CD = A.PROCESS_CD AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
					                FROM TB_STS_PROC A
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, EXECUT_CNT
					    )  AS result
				PIVOT ( AVG(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- E 절감시간
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, TOTAL_TM AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN , TOTAL_TM
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'E' AS GBN , MAX(REDCN_TM) AS REDCN_TM , TOTAL_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , PROCESS_CD
					                    , PROCESS_NM
					                    , ROUND(REDCN_TM,2) AS REDCN_TM
										, REDCN_TM AS TOTAL_TM
					                FROM TB_STS_PROC
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM , TOTAL_TM
					    )  AS result
				PIVOT ( MAX(REDCN_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- F 절감률
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN , REDCN_RATE_GROUP
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'F' AS GBN , MAX(REDCN_RATE) AS REDCN_RATE , REDCN_RATE_GROUP
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , PROCESS_CD
					                    , PROCESS_NM
					                    , REDCN_TM
										, JOB_TM
										, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
										, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
					                FROM TB_STS_PROC
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%') -- 박해선 AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
	                            -- 오류
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM , REDCN_RATE_GROUP
					    )  AS result
				PIVOT ( MAX(REDCN_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- G 가동시간
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN 
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'G' AS GBN , SUM(OPER_TM) AS OPER_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , PROCESS_CD
					                    , PROCESS_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
					                FROM TB_STS_PROC
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
					    )  AS result
				PIVOT ( SUM(OPER_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- H 가동률
		SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN 
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'H' AS GBN , SUM(OPER_RATE) AS OPER_RATE
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , PROCESS_CD
					                    , PROCESS_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
										, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
					                FROM TB_STS_PROC
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
					    )  AS result
				PIVOT ( SUM(OPER_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		) ZZ
	WHERE 1= 1
	GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
	
	UNION ALL
	
	SELECT  'ZZ' AS COMP_CD
	        , 'ZZ' AS COMP_NM
	        , 'ZZ' AS PROCESS_CD
	        , 'ZZ' AS PROCESS_NMGBN
	        , GBN
	        , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
	        , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
	        , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
	        , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
	        , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
	        , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
	        , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT                     
	FROM (
	        SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31
	                FROM (
	                        SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
	                        FROM (
	                        		SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_PROC A
	                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
	                                ON A.PROCESS_CD = B.PROCESS_CD
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	                                    -- 실행구분
	                                    AND B.EXECUT_SE IS NULL
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
									
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                    )  AS result
	                PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	            , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31
	                FROM (
	                        SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
	                        FROM (
	                        		SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_PROC A
									INNER JOIN TB_TASK_DEVLOP_PROCESS B
									ON A.PROCESS_CD = B.PROCESS_CD
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	                                    -- 실행구분
	                                    AND B.EXECUT_SE IS NULL
	                                    
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										
									UNION ALL 
								
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
										UNION ALL 
								
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_PROC A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                        )  AS result
	                PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	                ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31, 0 AS MON_TOT
	        FROM (
	                SELECT   YM, 'TC' AS GBN
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
	                FROM (
	                		SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_PROC A
								INNER JOIN TB_TASK_DEVLOP_PROCESS B
								ON A.PROCESS_CD = B.PROCESS_CD
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	                            -- 실행구분
	                            AND B.EXECUT_SE IS NULL
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
								
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM
	                ) AS result
	        PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	
	        UNION ALL
	
	        SELECT   GBN
	                , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                , SUM(MON_TOT) AS MON_TOT
	        FROM (
	                SELECT  'TC' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_PROC A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	
	                UNION ALL
	
	                SELECT   'TA' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	                UNION ALL
	
	                SELECT   'TB' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	                UNION ALL
	
	                SELECT   'TC' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TD' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TE' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TF' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TG' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TH' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_PROC
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                ) T
	            WHERE 1= 1
	            GROUP BY GBN
	
			UNION ALL
	
			SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , ROUND(CONVERT(FLOAT , (D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31)) / EXECUT_CNT , 2) AS MON_TOT
	        FROM (
	                SELECT   GBN , EXECUT_CNT
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31
	                FROM (
	                        SELECT YM, AVG(EXECUT_TM) AS EXECUT_TM, 'TD' AS GBN , EXECUT_CNT
	                        FROM (
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
											, DATEDIFF(SS , A.START_TIME , A.END_DT) AS EXECUT_TM
											, ( SELECT COUNT(DISTINCT(YMD)) FROM TB_STS_PROC B WHERE 1=1 AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
	                                FROM TB_STS_PROC A
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
										AND COMP_CD =  #{searchCmpnyCd}
									</if>
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM , EXECUT_CNT
	                    )  AS result
	                PIVOT ( AVG(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
			UNION ALL
	
			SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , TOTAL_TM AS MON_TOT
	        FROM (
				SELECT   GBN , TOTAL_TM
					, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					, ISNULL(D31,0) AS D31
				FROM (
	                SELECT YM, MIN(REDCN_TM) AS EXECUT_TM, 'TE' AS GBN , TOTAL_TM
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
									, ROUND(REDCN_TM,2) AS REDCN_TM
									, REDCN_TM AS TOTAL_TM
	                        FROM TB_STS_PROC A
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , TOTAL_TM
	            )  AS result
				PIVOT ( MIN(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , REDCN_RATE_GROUP AS MON_TOT
	        FROM (
				SELECT   GBN , REDCN_RATE_GROUP
					, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					, ISNULL(D31,0) AS D31
				FROM (
	                SELECT YM, MIN(REDCN_RATE) AS REDCN_RATE, 'TF' AS GBN , REDCN_RATE_GROUP
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
									, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
									, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
	                        FROM TB_STS_PROC A
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%') AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
	                        -- 오류
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , REDCN_RATE_GROUP
	            )  AS result
				PIVOT ( MIN(REDCN_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	           , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				, ISNULL(D31,0) AS D31
			FROM (
	            SELECT YM, SUM(OPER_TM) AS OPER_TM, 'TG' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
								, DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
	                    FROM TB_STS_PROC A
	                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				, ISNULL(D31,0) AS D31
			FROM (
	            SELECT YM, SUM(OPER_RATE) AS OPER_RATE, 'TH' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
								, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
	                    FROM TB_STS_PROC A
	                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
		) ZZ
	WHERE 1= 1
	
	GROUP BY GBN
	ORDER BY ZZ.COMP_CD, ZZ.PROCESS_CD, ZZ.GBN
    -- 통계 정렬
	</select>
	
	<select id="selectProcessRunStsListV2" parameterType="java.util.Map" resultType="camelMap">
	/* TaskManageMapper.selectProcessRunStsListV2 */
    SET ANSI_WARNINGS OFF
SET ARITHIGNORE ON
SET ARITHABORT OFF

    SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
            , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
            , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
            , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
            , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
            , SUM(MON_TOT) AS MON_TOT
    FROM (
        -- A 통계
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                , M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                         , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                         , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                         , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                         , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
                            FROM (
                                SELECT YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , COMP_CD
                                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                    , A.PROCESS_CD
                                    , A.PROCESS_NM
                                    , SUESS_CNT
                                FROM TB_STS_PROC A
                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                ON A.PROCESS_CD = B.PROCESS_CD
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD = '5'
                                -- 실행구분
                                AND B.EXECUT_SE IS NULL
                                
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                
                                UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , SUESS_CNT
                                FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD = '5'

                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY )

                                UNION ALL
                                -- 재실행 데이터 반영
                                SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , COMP_CD
                                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                    , A.PROCESS_CD
                                    , A.PROCESS_NM
                                    , SUESS_CNT
                                FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD = '5'

                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                
                                UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , SUESS_CNT
                                FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD = '5'

                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY )

                                UNION ALL
                                -- 재실행 데이터 반영
                                SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , COMP_CD
                                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                    , A.PROCESS_CD
                                    , A.PROCESS_NM
                                    , SUESS_CNT
                                FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD = '5'

                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                        )  AS result
                    PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- B 통계
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                 , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
                            FROM (
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , FAIL_CNT
                                FROM TB_STS_PROC A
                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                ON A.PROCESS_CD = B.PROCESS_CD
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '6')
                                -- 실행구분
                                AND B.EXECUT_SE IS NULL
                                
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                
                                UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , FAIL_CNT
                                    FROM TB_STS_PROC A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND B.ORIGINAL_AT = 1
                                    AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                                UNION ALL
    
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , FAIL_CNT
                                    FROM TB_STS_PROC A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                    
                                UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , FAIL_CNT
                                    FROM TB_STS_PROC A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND B.ORIGINAL_AT = 1
                                    AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                                UNION ALL
    
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , FAIL_CNT
                                    FROM TB_STS_PROC A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                        )  AS result
                PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- C(DAY) 통계
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                 , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                 , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                 , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                 , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
            FROM (
                SELECT   YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                    FROM (
                        SELECT   YMD
                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.PROCESS_CD
                                , A.PROCESS_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                            INNER JOIN TB_TASK_DEVLOP_PROCESS B
                            ON A.PROCESS_CD = B.PROCESS_CD
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
                            -- 실행구분
                            AND B.EXECUT_SE IS NULL
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            
                        UNION ALL
                        
                        SELECT   YMD
                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.PROCESS_CD
                                , A.PROCESS_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND B.ORIGINAL_AT = 1
                            AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.PROCESS_CD
                                , A.PROCESS_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                            
                        UNION ALL
                        
                        SELECT   YMD
                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.PROCESS_CD
                                , A.PROCESS_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND B.ORIGINAL_AT = 1
                            AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.PROCESS_CD
                                , A.PROCESS_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                        ) S
                    WHERE 1 = 1
                    GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                )  AS result
        PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
    
        UNION ALL
    
        -- C (TOTAL) 통계
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
                , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, SUM(MON_TOT) AS MON_TOT
        FROM (
            SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
                     , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                     , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
            FROM (
                    SELECT   YMD
                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.PROCESS_CD
                            , A.PROCESS_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                        FROM TB_STS_PROC A
                        INNER JOIN TB_TASK_DEVLOP_PROCESS B
                        ON A.PROCESS_CD = B.PROCESS_CD
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    AND STATE_CD IN ('2', '3', '4', '5', '6')
                    -- 실행구분
                    AND B.EXECUT_SE IS NULL
                    
                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                        AND COMP_CD =  #{searchCmpnyCd}
                    </if>
                        
                    UNION ALL
                    
                    SELECT   YMD
                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.PROCESS_CD
                            , A.PROCESS_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                        FROM TB_STS_PROC A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                        AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                        </if>
                        AND B.ORIGINAL_AT = 1
                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                    UNION ALL
    
                    SELECT   YMD
                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.PROCESS_CD
                            , A.PROCESS_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                    FROM TB_STS_PROC A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                    </if>
                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                    
                    UNION ALL
                    
                    SELECT   YMD
                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.PROCESS_CD
                            , A.PROCESS_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                        FROM TB_STS_PROC A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                        AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                        </if>
                        AND B.ORIGINAL_AT = 1
                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                    UNION ALL
    
                    SELECT   YMD
                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.PROCESS_CD
                            , A.PROCESS_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                    FROM TB_STS_PROC A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                    </if>
                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                    ) S
            WHERE 1 = 1
            GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
    
            UNION ALL
            --   C 합계
            SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'A' AS GBN
                    , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
            FROM TB_STS_PROC
            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
            </if>
    
            GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
    
            UNION ALL
    
            SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'B' AS GBN
                    , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
            FROM TB_STS_PROC
            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                AND COMP_CD =  #{searchCmpnyCd}
            </if>
    
            GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
    
            UNION ALL
    
            SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, PROCESS_CD, PROCESS_NM, 'C' AS GBN
                    , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
            FROM TB_STS_PROC
            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                AND COMP_CD =  #{searchCmpnyCd}
            </if>
    
            GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
            ) T
        WHERE 1= 1
        GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
    
        UNION ALL
    
        -- D 평균실행시간
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , ROUND(CONVERT(FLOAT , (M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)) / EXECUT_CNT , 2) AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN , EXECUT_CNT
                        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, AVG(EXECUT_TM) AS EXECUT_TM , 'D' AS GBN , EXECUT_CNT
                            FROM (
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.PROCESS_CD
                                        , A.PROCESS_NM
                                        , DATEDIFF(SS , START_TIME , END_DT) AS EXECUT_TM
                                        , ( SELECT COUNT(DISTINCT(CONCAT('M', SUBSTRING(YMD,6,2)))) FROM TB_STS_PROC B WHERE B.PROCESS_CD = A.PROCESS_CD AND YMD LIKE CONCAT(#{searchYear},'-','%')) AS EXECUT_CNT
                                    FROM TB_STS_PROC A
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, EXECUT_CNT
                        )  AS result
                PIVOT ( AVG(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- E 절감시간
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , TOTAL_TM AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN , TOTAL_TM
                        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'E' AS GBN , MAX(REDCN_TM) AS REDCN_TM , TOTAL_TM
                            FROM (
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , PROCESS_CD
                                        , PROCESS_NM
                                        , ROUND(REDCN_TM,2) AS REDCN_TM
                                        , REDCN_TM AS TOTAL_TM
                                    FROM TB_STS_PROC
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM , TOTAL_TM
                        )  AS result
                PIVOT ( MAX(REDCN_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- F 절감률
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN , REDCN_RATE_GROUP
                        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'F' AS GBN , MAX(REDCN_RATE) AS REDCN_RATE , REDCN_RATE_GROUP
                            FROM (
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , PROCESS_CD
                                        , PROCESS_NM
                                        , REDCN_TM
                                        , JOB_TM
                                        , CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
                                        , CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
                                    FROM TB_STS_PROC
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM , REDCN_RATE_GROUP
                        )  AS result
                PIVOT ( MAX(REDCN_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- G 가동시간
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                --, REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN 
                        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'G' AS GBN , SUM(OPER_TM) AS OPER_TM
                            FROM (
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , PROCESS_CD
                                        , PROCESS_NM
                                        , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
                                    FROM TB_STS_PROC
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                        )  AS result
                PIVOT ( SUM(OPER_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- H 가동률
        SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
                --, REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN 
                        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, 'H' AS GBN , SUM(OPER_RATE) AS OPER_RATE
                            FROM (
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , PROCESS_CD
                                        , PROCESS_NM
                                        , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
                                        , CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
                                            ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
                                            END AS OPER_RATE
                                    FROM TB_STS_PROC
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM
                        )  AS result
                PIVOT ( SUM(OPER_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        ) ZZ
    WHERE 1= 1
    GROUP BY COMP_CD, COMP_NM, PROCESS_CD, PROCESS_NM, GBN
    
    UNION ALL
    
    SELECT  'ZZ' AS COMP_CD
            , 'ZZ' AS COMP_NM
            , 'ZZ' AS PROCESS_CD
            , 'ZZ' AS PROCESS_NMGBN
            , GBN
            , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
            , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
            , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
            , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
            , SUM(MON_TOT) AS MON_TOT                  
    FROM (
            SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                    , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
            FROM (
                    SELECT   GBN
            , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
                            SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
                            FROM (
                                SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , SUESS_CNT
                                FROM TB_STS_PROC A
                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                ON A.PROCESS_CD = B.PROCESS_CD
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                   AND STATE_CD = '5'
                                   -- 실행구분
                                   AND B.EXECUT_SE IS NULL

                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                                                        
                                    UNION ALL
                                    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                        
                                    UNION ALL
                                    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                    ) S
                            WHERE 1 = 1
                            GROUP BY YM
                        )  AS result
                    PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
            WHERE 1 = 1
    
            UNION ALL
    
            SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
            FROM (
                    SELECT   GBN
            , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
                            SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
                            FROM (
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_PROC A
                                    INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                    ON A.PROCESS_CD = B.PROCESS_CD
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
                                        -- 실행구분
                                        AND B.EXECUT_SE IS NULL
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                        
                                    UNION ALL
                                    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                        
                                    UNION ALL
                                    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_PROC A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                    ) S
                            WHERE 1 = 1
                            GROUP BY YM
                            )  AS result
                    PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                    ) AA
            WHERE 1 = 1
    
            UNION ALL
    
            SELECT   GBN
            , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
            FROM (
                    SELECT   YM, 'TC' AS GBN
                            , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                    FROM (
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                            INNER JOIN TB_TASK_DEVLOP_PROCESS B
                            ON A.PROCESS_CD = B.PROCESS_CD
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
                                -- 실행구분
                                AND B.EXECUT_SE IS NULL
                                
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                            
                            UNION ALL
                            
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                
                            UNION ALL
                            
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                            ) S
                    WHERE 1 = 1
                    GROUP BY YM
                    ) AS result
            PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
    
            UNION ALL
    
            SELECT   GBN
                    , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                    , SUM(MON_TOT) AS MON_TOT
            FROM (
                    SELECT  'TC' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
                    FROM (
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_PROC A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
    
                            ) S
                    WHERE 1 = 1
    
                    UNION ALL
    
                    SELECT   'TA' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                    UNION ALL
    
                    SELECT   'TB' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                    UNION ALL
    
                    SELECT   'TC' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    
                    UNION ALL
    
                    SELECT   'TD' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    
                    UNION ALL
    
                    SELECT   'TE' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    
                    UNION ALL
    
                    SELECT   'TF' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    
                    UNION ALL
    
                    SELECT   'TG' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    
                    UNION ALL
    
                    SELECT   'TH' AS GBN
                            , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                            , 0 AS MON_TOT
                    FROM TB_STS_PROC
                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                    ) T
                WHERE 1= 1
                GROUP BY GBN
    
            UNION ALL
    
            SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                    , ROUND(CONVERT(FLOAT , (M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)) / EXECUT_CNT , 2) AS MON_TOT
            FROM (
                    SELECT   GBN , EXECUT_CNT
            , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                    FROM (
                            SELECT YM, AVG(EXECUT_TM) AS EXECUT_TM, 'TD' AS GBN , EXECUT_CNT
                            FROM (
                                    SELECT   YMD
                                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                            , DATEDIFF(SS , A.START_TIME , A.END_DT) AS EXECUT_TM
                                            , ( SELECT COUNT(DISTINCT(CONCAT('M', SUBSTRING(YMD,6,2)))) FROM TB_STS_PROC B WHERE 1=1 AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
                                    FROM TB_STS_PROC A
                                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
    
                                    ) S
                            WHERE 1 = 1
                            GROUP BY YM , EXECUT_CNT
                        )  AS result
                    PIVOT ( AVG(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
                ) AA
            WHERE 1 = 1
    
            UNION ALL
    
            SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                    , TOTAL_TM AS MON_TOT
            FROM (
                SELECT   GBN , TOTAL_TM
                    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                    , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                    , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                    , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                FROM (
                    SELECT YM, MIN(REDCN_TM) AS EXECUT_TM, 'TE' AS GBN , TOTAL_TM
                    FROM (
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , ROUND(REDCN_TM,2) AS REDCN_TM
                                    , REDCN_TM AS TOTAL_TM
                            FROM TB_STS_PROC A
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                AND COMP_CD =  #{searchCmpnyCd}
                            </if>
    
                            ) S
                    WHERE 1 = 1
                    GROUP BY YM , TOTAL_TM
                )  AS result
                PIVOT ( MIN(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
            ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                    , REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   GBN , REDCN_RATE_GROUP
                    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                    , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                    , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                    , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
                FROM (
                    SELECT YM, MIN(REDCN_RATE) AS REDCN_RATE, 'TF' AS GBN , REDCN_RATE_GROUP
                    FROM (
                            SELECT   YMD
                                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                    , CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
                                    , CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
                            FROM TB_STS_PROC A
                            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                AND COMP_CD =  #{searchCmpnyCd}
                            </if>
    
                            ) S
                    WHERE 1 = 1
                    GROUP BY YM , REDCN_RATE_GROUP
                )  AS result
                PIVOT ( MIN(REDCN_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
            ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
               , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
        FROM (
            SELECT   GBN 
                , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
            FROM (
                SELECT YM, SUM(OPER_TM) AS OPER_TM, 'TG' AS GBN
                FROM (
                        SELECT   YMD
                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
                        FROM TB_STS_PROC A
                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                            AND COMP_CD =  #{searchCmpnyCd}
                        </if>
    
                        ) S
                WHERE 1 = 1
                GROUP BY YM
                )  AS result
            PIVOT ( SUM(OPER_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
            ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
        FROM (
            SELECT   GBN 
                , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
            FROM (
                SELECT YM, SUM(OPER_RATE) AS OPER_RATE, 'TH' AS GBN
                FROM (
                        SELECT   YMD
                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                , CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
                                            ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
                                            END AS OPER_RATE
                        FROM TB_STS_PROC A
                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                            AND COMP_CD =  #{searchCmpnyCd}
                        </if>
    
                        ) S
                WHERE 1 = 1
                GROUP BY YM
                )  AS result
            PIVOT ( SUM(OPER_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
            ) AA
        WHERE 1 = 1
        ) ZZ
    WHERE 1= 1
    
    GROUP BY GBN
    ORDER BY ZZ.COMP_CD, ZZ.PROCESS_CD, ZZ.GBN
    -- 통계 정렬
	</select>
	
	
	<select id="selectRobotRunMonthStsListV2" parameterType="java.util.Map" resultType="camelMap">
    /* TaskManageMapper.selectRobotRunMonthStsListV2 */
    
    SET ANSI_WARNINGS OFF
SET ARITHIGNORE ON
SET ARITHABORT OFF
    
    SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
            , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
            , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
            , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
            , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
            , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
            , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
            , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT
    FROM (
        -- A 통계
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                , D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                        , ISNULL(D31,0) AS D31
                    FROM (
                        SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
                            FROM (
                            
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        ,A.ROBOT_ID
                                        ,A.BOT_NM
                                        , SUESS_CNT
                                    FROM TB_STS_BOT A
                                    INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                    ON A.PROCESS_CD = B.PROCESS_CD
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD = '5'
                                    -- 실행구분
                                    AND B.EXECUT_SE IS NULL
                                    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    
                                UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        ,A.ROBOT_ID
                                        ,A.BOT_NM
                                        , SUESS_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD = '5'
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND B.ORIGINAL_AT = 1
                                    AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY )
    
                                    UNION ALL
                                    -- 재실행 데이터 반영
                                    SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , SUESS_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD = '5'
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                    
                                    UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , SUESS_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD = '5'
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND B.ORIGINAL_AT = 1
                                    AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY )
    
                                    UNION ALL
                                    -- 재실행 데이터 반영
                                    SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , SUESS_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD = '5'
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                        )  AS result
                    PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- B 통계
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                        , ISNULL(D31,0) AS D31
                    FROM (
                        SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
                            FROM (
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , FAIL_CNT
                                    FROM TB_STS_BOT A
                                    INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                    ON A.PROCESS_CD = B.PROCESS_CD
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
                                    -- 실행구분
                                    AND B.EXECUT_SE IS NULL
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    
                                UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , FAIL_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND B.ORIGINAL_AT = 1
                                    AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                                UNION ALL
    
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , FAIL_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                    
                                UNION ALL
                                
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , FAIL_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND B.ORIGINAL_AT = 1
                                    AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                                UNION ALL
    
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , FAIL_CNT
                                    FROM TB_STS_BOT A
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                    LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                    AND STATE_CD IN ('2', '3', '4', '6')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
                                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                        )  AS result
                PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- C(DAY) 통계
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                , ISNULL(D31,0) AS D31, 0 AS MON_TOT
            FROM (
                SELECT   YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                    FROM (
                        SELECT   YMD
                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.ROBOT_ID
                                , A.BOT_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                            INNER JOIN TB_TASK_DEVLOP_PROCESS B
                            ON A.PROCESS_CD = B.PROCESS_CD
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
                            -- 실행구분
                            AND B.EXECUT_SE IS NULL
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            
                        UNION ALL
                        
                        SELECT   YMD
                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.ROBOT_ID
                                , A.BOT_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND B.ORIGINAL_AT = 1
                            AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.ROBOT_ID
                                , A.BOT_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                            
                            UNION ALL
                        
                        SELECT   YMD
                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.ROBOT_ID
                                , A.BOT_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND B.ORIGINAL_AT = 1
                            AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                , COMP_CD
                                , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                , A.ROBOT_ID
                                , A.BOT_NM
                                , SUESS_CNT
                                , FAIL_CNT
                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                            AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                            </if>
                            AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                        ) S
                    WHERE 1 = 1
                    GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                )  AS result
        PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
    
        UNION ALL
    
        -- C (TOTAL) 통계
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
                , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                , SUM(MON_TOT) AS MON_TOT
        FROM (
            SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
                    , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                    , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                    , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                    , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
            FROM (
                    SELECT   YMD
                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.ROBOT_ID
                            , A.BOT_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                        FROM TB_STS_BOT A
                        INNER JOIN TB_TASK_DEVLOP_PROCESS B
                        ON A.PROCESS_CD = B.PROCESS_CD
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                        AND STATE_CD IN ('2', '3', '4', '5', '6')
                        -- 실행구분
                        AND B.EXECUT_SE IS NULL
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                        </if>
                        
                    UNION ALL
                    
                    SELECT   YMD
                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.ROBOT_ID
                            , A.BOT_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                        FROM TB_STS_BOT A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                        AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                        </if>
                        AND B.ORIGINAL_AT = 1
                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                    UNION ALL
    
                    SELECT   YMD
                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.ROBOT_ID
                            , A.BOT_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                    FROM TB_STS_BOT A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                    </if>
                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                    
                    UNION ALL
                    
                    SELECT   YMD
                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.ROBOT_ID
                            , A.BOT_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                        FROM TB_STS_BOT A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                        AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                        </if>
                        AND B.ORIGINAL_AT = 1
                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                    UNION ALL
    
                    SELECT   YMD
                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                            , COMP_CD
                            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                            , A.ROBOT_ID
                            , A.BOT_NM
                            , SUESS_CNT
                            , FAIL_CNT
                            , FAIL_CNT + SUESS_CNT AS TOT_CNT
                    FROM TB_STS_BOT A
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
                    </if>
                    AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                    ) S
            WHERE 1 = 1
            GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
    
            UNION ALL
            --   C 합계
            SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'A' AS GBN
                    , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                    , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                    , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                    , 0 AS MON_TOT
            FROM TB_STS_BOT
            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                                   AND COMP_CD =  #{searchCmpnyCd}
            </if>
    
            GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
    
            UNION ALL
    
            SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'B' AS GBN
                    , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                    , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                    , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                    , 0 AS MON_TOT
            FROM TB_STS_BOT
            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                AND COMP_CD =  #{searchCmpnyCd}
            </if>
    
            GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
    
            UNION ALL
    
            SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
                    , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                    , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                    , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                    , 0 AS MON_TOT
            FROM TB_STS_BOT
            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                AND COMP_CD =  #{searchCmpnyCd}
            </if>
    
            GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
            ) T
        WHERE 1= 1
        GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
    
        UNION ALL
    
        -- D 평균실행시간
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , ROUND(CONVERT(FLOAT , (D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31)) / EXECUT_CNT , 2) AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN , EXECUT_CNT
                        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                        , ISNULL(D31,0) AS D31
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, AVG(EXECUT_TM) AS EXECUT_TM , 'D' AS GBN , EXECUT_CNT
                            FROM (
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , A.ROBOT_ID
                                        , A.BOT_NM
                                        , DATEDIFF(SS , START_TIME , END_DT) AS EXECUT_TM
                                        , ( SELECT COUNT(DISTINCT(YMD)) FROM TB_STS_PROC B WHERE B.PROCESS_CD = A.PROCESS_CD AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
                                    FROM TB_STS_BOT A
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, EXECUT_CNT
                        )  AS result
                PIVOT ( AVG(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- E 절감시간
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , TOTAL_TM AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN , TOTAL_TM
                        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                        , ISNULL(D31,0) AS D31
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'E' AS GBN , MAX(REDCN_TM) AS REDCN_TM , TOTAL_TM
                            FROM (
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , ROBOT_ID
                                        , BOT_NM
                                        , ROUND(REDCN_TM,2) AS REDCN_TM
                                        , REDCN_TM AS TOTAL_TM
                                    FROM TB_STS_BOT
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, TOTAL_TM
                        )  AS result
                PIVOT ( MAX(REDCN_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- F 절감률
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN , REDCN_RATE_GROUP
                        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                        , ISNULL(D31,0) AS D31
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'F' AS GBN , MAX(REDCN_RATE) AS REDCN_RATE , REDCN_RATE_GROUP
                            FROM (
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , ROBOT_ID
                                        , BOT_NM
                                        , REDCN_TM
                                        , JOB_TM
                                        , CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
                                        , CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
                                    FROM TB_STS_BOT
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%') AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
                                 -- 오류
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, REDCN_RATE_GROUP
                        )  AS result
                PIVOT ( MAX(REDCN_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- G 가동시간
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
                --, REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN 
                        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                        , ISNULL(D31,0) AS D31
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'G' AS GBN , SUM(OPER_TM) AS OPER_TM
                            FROM (
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , ROBOT_ID
                                        , BOT_NM
                                        , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
                                    FROM TB_STS_BOT
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                        )  AS result
                PIVOT ( SUM(OPER_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        -- H 가동률
        SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
                --, REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN 
                        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                        , ISNULL(D31,0) AS D31
                    FROM (
    
                        SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'H' AS GBN , SUM(OPER_RATE) AS OPER_RATE
                            FROM (
                                SELECT   YMD
                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                        , COMP_CD
                                        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
                                        , ROBOT_ID
                                        , BOT_NM
                                        , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
                                        , CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
                                            ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
                                            END AS OPER_RATE
                                    FROM TB_STS_BOT
                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
    
                                ) S
                            WHERE 1 = 1
                            GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
                        )  AS result
                PIVOT ( SUM(OPER_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
        WHERE 1 = 1
    
        ) ZZ
    WHERE 1= 1
    GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
    
    UNION ALL
    
    SELECT  'ZZ' AS COMP_CD
            , 'ZZ' AS COMP_NM
            , 00 AS ROBOT_ID
            , 'ZZ' AS BOT_NM
            , GBN
            , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
            , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
            , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
            , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
            , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
            , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
            , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT                     
    FROM (
            SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                    , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
            FROM (
                    SELECT   GBN
            , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
            , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
            , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
            , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
            , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
            , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
            , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
            , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
            , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
            , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
            , ISNULL(D31,0) AS D31
                    FROM (
                            SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
                            FROM (
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_BOT A
                                    INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                    ON A.PROCESS_CD = B.PROCESS_CD
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD = '5'
                                        -- 실행구분
                                        AND B.EXECUT_SE IS NULL
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                    
                                    UNION ALL
                                    
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                        
                                    UNION ALL
                                    
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , SUESS_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD = '5'
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                    ) S
                            WHERE 1 = 1
                            GROUP BY YM
                        )  AS result
                    PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
            WHERE 1 = 1
    
            UNION ALL
    
            SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
            FROM (
                    SELECT   GBN
            , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
            , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
            , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
            , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
            , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
            , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
            , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
            , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
            , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
            , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
            , ISNULL(D31,0) AS D31
                    FROM (
                            SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
                            FROM (
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_BOT A
                                    INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                    ON A.PROCESS_CD = B.PROCESS_CD
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
                                        -- 실행구분
                                        AND B.EXECUT_SE IS NULL
                                        
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        
                                    UNION ALL 
                                
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                        
                                        UNION ALL 
                                
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND B.ORIGINAL_AT = 1
                                        AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                                    UNION ALL
    
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , FAIL_CNT
                                    FROM TB_STS_BOT A
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                        LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                        AND STATE_CD IN ('2', '3', '4', '6')
    
                                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                            AND COMP_CD =  #{searchCmpnyCd}
                                        </if>
                                        AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                                    ) S
                            WHERE 1 = 1
                            GROUP BY YM
                            )  AS result
                    PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                    ) AA
            WHERE 1 = 1
    
            UNION ALL
    
            SELECT   GBN
            , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
            , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
            , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
            , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
            , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
            , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
            , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
            , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
            , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
            , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
            , ISNULL(D31,0) AS D31, 0 AS MON_TOT
            FROM (
                    SELECT   YM, 'TC' AS GBN
                            , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
                    FROM (
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                ON A.PROCESS_CD = B.PROCESS_CD
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
                                -- 실행구분
                                AND B.EXECUT_SE IS NULL
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                
                            UNION ALL
                            
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
                                
                            UNION ALL
                            
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
    
                            ) S
                    WHERE 1 = 1
                    GROUP BY YM
                    ) AS result
            PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
    
            UNION ALL
    
            SELECT   GBN
                    , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                    , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                    , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                    , SUM(MON_TOT) AS MON_TOT
            FROM (
                    SELECT  'TC' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
                    FROM (
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND B.ORIGINAL_AT = 1
                                AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
    
                            UNION ALL
    
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , SUESS_CNT
                                    , FAIL_CNT
                                    , FAIL_CNT + SUESS_CNT AS TOT_CNT
                            FROM TB_STS_BOT A
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
                                LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                                AND STATE_CD IN ('2', '3', '4', '5', '6')
    
                                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                    AND COMP_CD =  #{searchCmpnyCd}
                                </if>
                                AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
    
                            ) S
                    WHERE 1 = 1
    
                    UNION ALL
    
                    SELECT   'TA' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                    UNION ALL
    
                    SELECT   'TB' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                    UNION ALL
    
                    SELECT   'TC' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    
                    UNION ALL
    
                    SELECT   'TD' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    
                    UNION ALL
    
                    SELECT   'TE' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    
                    UNION ALL
    
                    SELECT   'TF' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    
                    UNION ALL
    
                    SELECT   'TG' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    
                    UNION ALL
    
                    SELECT   'TH' AS GBN
                            , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
                            , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
                            , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
                            , 0 AS MON_TOT
                    FROM TB_STS_BOT
                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
                    ) T
                WHERE 1= 1
                GROUP BY GBN
    
            UNION ALL
    
            SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                    , ROUND(CONVERT(FLOAT , (D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31)) / EXECUT_CNT , 2) AS MON_TOT
            FROM (
                    SELECT   GBN , EXECUT_CNT
            , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
            , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
            , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
            , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
            , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
            , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
            , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
            , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
            , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
            , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
            , ISNULL(D31,0) AS D31
                    FROM (
                            SELECT YM, AVG(EXECUT_TM) AS EXECUT_TM, 'TD' AS GBN , EXECUT_CNT
                            FROM (
                                    SELECT   YMD
                                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                            , DATEDIFF(SS , A.START_TIME , A.END_DT) AS EXECUT_TM
                                            , ( SELECT COUNT(DISTINCT(YMD)) FROM TB_STS_PROC B WHERE 1=1 AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
                                    FROM TB_STS_BOT A
                                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                        AND COMP_CD =  #{searchCmpnyCd}
                                    </if>
    
                                    ) S
                            WHERE 1 = 1
                            GROUP BY YM , EXECUT_CNT
                        )  AS result
                    PIVOT ( AVG(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
                ) AA
            WHERE 1 = 1
    
            UNION ALL
    
            SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                    , TOTAL_TM AS MON_TOT
            FROM (
                SELECT   GBN , TOTAL_TM
                    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                    , ISNULL(D31,0) AS D31
                FROM (
                    SELECT YM, MIN(REDCN_TM) AS EXECUT_TM, 'TE' AS GBN , TOTAL_TM
                    FROM (
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , ROUND(REDCN_TM,2) AS REDCN_TM
                                    , REDCN_TM AS TOTAL_TM
                            FROM TB_STS_BOT A
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                AND COMP_CD =  #{searchCmpnyCd}
                            </if>
    
                            ) S
                    WHERE 1 = 1
                    GROUP BY YM , TOTAL_TM
                )  AS result
                PIVOT ( MIN(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
            ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                    , REDCN_RATE_GROUP AS MON_TOT
            FROM (
                SELECT   GBN , REDCN_RATE_GROUP
                    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                    , ISNULL(D31,0) AS D31
                FROM (
                    SELECT YM, MIN(REDCN_RATE) AS REDCN_RATE, 'TF' AS GBN , REDCN_RATE_GROUP
                    FROM (
                            SELECT   YMD
                                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                    , CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
                                    , CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
                            FROM TB_STS_BOT A
                            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%') AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
                            -- 오류
                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                                AND COMP_CD =  #{searchCmpnyCd}
                            </if>
    
                            ) S
                    WHERE 1 = 1
                    GROUP BY YM , REDCN_RATE_GROUP
                )  AS result
                PIVOT ( MIN(REDCN_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
            ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
               , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
        FROM (
            SELECT   GBN 
                , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                , ISNULL(D31,0) AS D31
            FROM (
                SELECT YM, SUM(OPER_TM) AS OPER_TM, 'TG' AS GBN
                FROM (
                        SELECT   YMD
                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
                        FROM TB_STS_BOT A
                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                            AND COMP_CD =  #{searchCmpnyCd}
                        </if>
    
                        ) S
                WHERE 1 = 1
                GROUP BY YM
                )  AS result
            PIVOT ( SUM(OPER_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
            ) AA
        WHERE 1 = 1
    
        UNION ALL
    
        SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
        FROM (
            SELECT   GBN 
                , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
                , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
                , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
                , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
                , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
                , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
                , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
                , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
                , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
                , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
                , ISNULL(D31,0) AS D31
            FROM (
                SELECT YM, SUM(OPER_RATE) AS OPER_RATE, 'TH' AS GBN
                FROM (
                        SELECT   YMD
                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
                                , CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
                                            ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
                                            END AS OPER_RATE
                        FROM TB_STS_BOT A
                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
    
                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
                            AND COMP_CD =  #{searchCmpnyCd}
                        </if>
    
                        ) S
                WHERE 1 = 1
                GROUP BY YM
                )  AS result
            PIVOT ( SUM(OPER_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
            ) AA
        WHERE 1 = 1
        ) ZZ
    WHERE 1= 1
    
    GROUP BY GBN
    ORDER BY ZZ.COMP_CD, ZZ.ROBOT_ID, ZZ.GBN
    --통계 정렬
    </select>
	
	
	
	
	
	
	
	
	
	
	
	<!-- 로봇별실행현황 - 년도별 -->
	<select id="selectRobotRunYearStsListV2" parameterType="java.util.Map" resultType="camelMap">
	/* ExecutStatsMapper.selectRobotRunYearStsListV2 */
	
	SET ANSI_WARNINGS OFF
    SET ARITHIGNORE ON
    SET ARITHABORT OFF
	
	SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
			, SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
            , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
            , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
            , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
            , SUM(MON_TOT) AS MON_TOT
	FROM (
		-- A 통계
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
				, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
					     , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                         , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                         , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                         , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
					        FROM (
					        	SELECT YMD
				                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
				                    , COMP_CD
				                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                    , A.ROBOT_ID
				                    , A.BOT_NM
				                    , SUESS_CNT
				                FROM TB_STS_BOT A
				                INNER JOIN TB_TASK_DEVLOP_PROCESS B
				                ON A.PROCESS_CD = B.PROCESS_CD
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'
				                -- 실행구분
				                AND B.EXECUT_SE IS NULL
				                
				                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
					            
					            UNION ALL
					            
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , SUESS_CNT
				                FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY )

								UNION ALL
								-- 재실행 데이터 반영
								SELECT   YMD
				                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
				                    , COMP_CD
				                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                    , A.ROBOT_ID
				                    , A.BOT_NM
				                    , SUESS_CNT
				                FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
								
								UNION ALL
								
								SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , SUESS_CNT
				                FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY )

								UNION ALL
								-- 재실행 데이터 반영
								SELECT   YMD
				                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
				                    , COMP_CD
				                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                    , A.ROBOT_ID
				                    , A.BOT_NM
				                    , SUESS_CNT
				                FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
					    )  AS result
					PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- B 통계
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                 , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
					        FROM (
					        	SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , FAIL_CNT
					            FROM TB_STS_BOT A
								INNER JOIN TB_TASK_DEVLOP_PROCESS B
								ON A.PROCESS_CD = B.PROCESS_CD
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					            AND STATE_CD IN ('2', '3', '4', '6')
					            -- 실행구분
					            AND B.EXECUT_SE IS NULL
					            
					            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
					            
					            UNION ALL
					            
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , FAIL_CNT
					                FROM TB_STS_BOT A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , FAIL_CNT
					                FROM TB_STS_BOT A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
									
								UNION ALL
					            
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , FAIL_CNT
					                FROM TB_STS_BOT A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , FAIL_CNT
					                FROM TB_STS_BOT A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
					    )  AS result
				PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- C(DAY) 통계
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
				 , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                 , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                 , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                 , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
			FROM (
				SELECT   YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
					    , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
					FROM (
						SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.ROBOT_ID
					            , A.BOT_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_BOT A
							INNER JOIN TB_TASK_DEVLOP_PROCESS B
							ON A.PROCESS_CD = B.PROCESS_CD
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
					        AND B.EXECUT_SE IS NULL
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                	AND COMP_CD =  #{searchCmpnyCd}
			                </if>
			                
			            UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.ROBOT_ID
					            , A.BOT_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.ROBOT_ID
					            , A.BOT_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
							
						UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.ROBOT_ID
					            , A.BOT_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                	AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.ROBOT_ID
					            , A.BOT_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                	AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					    ) S
					WHERE 1 = 1
					GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
				)  AS result
		PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	
		UNION ALL
	
		-- C (TOTAL) 통계
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
				, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, SUM(MON_TOT) AS MON_TOT
		FROM (
			SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
					 , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                     , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
			FROM (
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.ROBOT_ID
					        , A.BOT_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_BOT A
						INNER JOIN TB_TASK_DEVLOP_PROCESS B
						ON A.PROCESS_CD = B.PROCESS_CD
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				    AND STATE_CD IN ('2', '3', '4', '5', '6')
					AND B.EXECUT_SE IS NULL
					
                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		            	AND COMP_CD =  #{searchCmpnyCd}
		            </if>
			            
			        UNION ALL
			        
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.ROBOT_ID
					        , A.BOT_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_BOT A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.ROBOT_ID
					        , A.BOT_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_BOT A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
					
					UNION ALL
			        
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.ROBOT_ID
					        , A.BOT_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_BOT A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.ROBOT_ID
					        , A.BOT_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_BOT A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					) S
			WHERE 1 = 1
			GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
	
			UNION ALL
			--   C 합계
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'A' AS GBN
					, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
			FROM TB_STS_BOT
			WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'B' AS GBN
					, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
			FROM TB_STS_BOT
			WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, ROBOT_ID, BOT_NM, 'C' AS GBN
					, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
			FROM TB_STS_BOT
			WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
			) T
		WHERE 1= 1
		GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
	
		UNION ALL
	
		-- D 평균실행시간
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, ROUND(CONVERT(FLOAT , (M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)) / EXECUT_CNT , 2) AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN , EXECUT_CNT
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, AVG(EXECUT_TM) AS EXECUT_TM , 'D' AS GBN , EXECUT_CNT
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.ROBOT_ID
					                    , A.BOT_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS EXECUT_TM
										, ( SELECT COUNT(DISTINCT(CONCAT('M', SUBSTRING(YMD,6,2)))) FROM TB_STS_BOT B WHERE B.ROBOT_ID = A.ROBOT_ID AND YMD LIKE CONCAT(#{searchYear},'-','%')) AS EXECUT_CNT
					                FROM TB_STS_BOT A
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, EXECUT_CNT
					    )  AS result
				PIVOT ( AVG(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- E 절감시간
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, TOTAL_TM AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN , TOTAL_TM
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'E' AS GBN , MAX(REDCN_TM) AS REDCN_TM , TOTAL_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , ROBOT_ID
					                    , BOT_NM
					                    , ROUND(REDCN_TM,2) AS REDCN_TM
										, REDCN_TM AS TOTAL_TM
					                FROM TB_STS_BOT
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM , TOTAL_TM
					    )  AS result
				PIVOT ( MAX(REDCN_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- F 절감률
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN , REDCN_RATE_GROUP
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'F' AS GBN , MAX(REDCN_RATE) AS REDCN_RATE , REDCN_RATE_GROUP
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , ROBOT_ID
					                    , BOT_NM
					                    , REDCN_TM
										, JOB_TM
										, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
										, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
					                FROM TB_STS_BOT
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%') -- 박해선 AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM , REDCN_RATE_GROUP
					    )  AS result
				PIVOT ( MAX(REDCN_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- G 가동시간
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN 
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'G' AS GBN , SUM(OPER_TM) AS OPER_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , ROBOT_ID
					                    , BOT_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
					                FROM TB_STS_BOT
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
					    )  AS result
				PIVOT ( SUM(OPER_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- H 가동률
		SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN 
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, 'H' AS GBN , SUM(OPER_RATE) AS OPER_RATE
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , ROBOT_ID
					                    , BOT_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
										, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
					                FROM TB_STS_BOT
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, ROBOT_ID, BOT_NM
					    )  AS result
				PIVOT ( SUM(OPER_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		) ZZ
	WHERE 1= 1
	GROUP BY COMP_CD, COMP_NM, ROBOT_ID, BOT_NM, GBN
	
	UNION ALL
	
	SELECT  'ZZ' AS COMP_CD
	        , 'ZZ' AS COMP_NM
	        , 00 AS ROBOT_ID
	        , 'ZZ' AS BOT_NM
	        , GBN
	        , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
            , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
            , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
            , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
            , SUM(MON_TOT) AS MON_TOT                  
	FROM (
	        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
	                FROM (
	                        SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
	                        FROM (
                        		SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , SUESS_CNT
                                FROM TB_STS_BOT A
                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                ON A.PROCESS_CD = B.PROCESS_CD
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                   AND STATE_CD = '5'
                                   AND B.EXECUT_SE IS NULL

	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
																		
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                    )  AS result
	                PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	            , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
	                FROM (
	                        SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
	                        FROM (
	                        		SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_BOT A
	                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
	                                ON A.PROCESS_CD = B.PROCESS_CD
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	                                    AND B.EXECUT_SE IS NULL
	
		                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
										AND COMP_CD =  #{searchCmpnyCd}
									</if>
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_BOT A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                        )  AS result
	                PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	                ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
	        FROM (
	                SELECT   YM, 'TC' AS GBN
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
	                FROM (
	                		SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_BOT A
	                        INNER JOIN TB_TASK_DEVLOP_PROCESS B
	                        ON A.PROCESS_CD = B.PROCESS_CD
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	                            AND B.EXECUT_SE IS NULL
	                            
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
							
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
								
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM
	                ) AS result
	        PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	
	        UNION ALL
	
	        SELECT   GBN
	                , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                , SUM(MON_TOT) AS MON_TOT
	        FROM (
	                SELECT  'TC' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_BOT A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	
	                UNION ALL
	
	                SELECT   'TA' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	                UNION ALL
	
	                SELECT   'TB' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	                UNION ALL
	
	                SELECT   'TC' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TD' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TE' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TF' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TG' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TH' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_BOT
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                ) T
	            WHERE 1= 1
	            GROUP BY GBN
	
			UNION ALL
	
			SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , ROUND(CONVERT(FLOAT , (M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)) / EXECUT_CNT , 2) AS MON_TOT
	        FROM (
	                SELECT   GBN , EXECUT_CNT
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
	                FROM (
	                        SELECT YM, AVG(EXECUT_TM) AS EXECUT_TM, 'TD' AS GBN , EXECUT_CNT
	                        FROM (
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
											, DATEDIFF(SS , A.START_TIME , A.END_DT) AS EXECUT_TM
											, ( SELECT COUNT(DISTINCT(CONCAT('M', SUBSTRING(YMD,6,2)))) FROM TB_STS_BOT B WHERE 1=1 AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
	                                FROM TB_STS_BOT A
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
										AND COMP_CD =  #{searchCmpnyCd}
									</if>
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM , EXECUT_CNT
	                    )  AS result
	                PIVOT ( AVG(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
			UNION ALL
	
			SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , TOTAL_TM AS MON_TOT
	        FROM (
				SELECT   GBN , TOTAL_TM
					, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                    , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                    , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                    , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
				FROM (
	                SELECT YM, MIN(REDCN_TM) AS EXECUT_TM, 'TE' AS GBN , TOTAL_TM
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
									, ROUND(REDCN_TM,2) AS REDCN_TM
									, REDCN_TM AS TOTAL_TM
	                        FROM TB_STS_BOT A
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , TOTAL_TM
	            )  AS result
				PIVOT ( MIN(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , REDCN_RATE_GROUP AS MON_TOT
	        FROM (
				SELECT   GBN , REDCN_RATE_GROUP
					, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                    , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                    , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                    , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
				FROM (
	                SELECT YM, MIN(REDCN_RATE) AS REDCN_RATE, 'TF' AS GBN , REDCN_RATE_GROUP
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
									, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
									, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
	                        FROM TB_STS_BOT A
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%') -- 박해선 AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
	
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , REDCN_RATE_GROUP
	            )  AS result
				PIVOT ( MIN(REDCN_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	           , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
			FROM (
	            SELECT YM, SUM(OPER_TM) AS OPER_TM, 'TG' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
								, DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
	                    FROM TB_STS_BOT A
	                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
			FROM (
	            SELECT YM, SUM(OPER_RATE) AS OPER_RATE, 'TH' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
								, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
	                    FROM TB_STS_BOT A
	                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
		) ZZ
	WHERE 1= 1

	GROUP BY GBN
	ORDER BY ZZ.COMP_CD, ZZ.ROBOT_ID, ZZ.GBN
    --통계 정렬
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

	<select id="selectTaskRunMonthStsListV2" parameterType="java.util.Map" resultType="camelMap">
	/* ExecutStatsMapper.selectTaskRunMonthStsListV2 */
	
	SET ANSI_WARNINGS OFF
    SET ARITHIGNORE ON
    SET ARITHABORT OFF
	
	SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
			, SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
			, SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
			, SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
			, SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
			, SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
			, SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
			, SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT
	FROM (
		-- A 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
				, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
					        FROM (
					        
					        	SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    ,A.TASK_CD
										,A.TASK_NM
					                    , SUESS_CNT
					                FROM TB_STS_TASK A
									INNER JOIN TB_TASK_DEVLOP_PROCESS B
									ON A.PROCESS_CD = B.PROCESS_CD
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
					                AND B.EXECUT_SE IS NULL
					                
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
			                        
			                    UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    ,A.TASK_CD
										,A.TASK_NM
					                    , SUESS_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY )
	
									UNION ALL
									-- 재실행 데이터 반영
									SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , SUESS_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
									
									UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , SUESS_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY )
	
									UNION ALL
									-- 재실행 데이터 반영
									SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , SUESS_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD = '5'
	
				                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
					PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- B 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
					        FROM (
					        	SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									INNER JOIN TB_TASK_DEVLOP_PROCESS B
									ON A.PROCESS_CD = B.PROCESS_CD
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
					                AND B.EXECUT_SE IS NULL
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
			                        
			                    UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
									
								UNION ALL
			                    
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
				PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- C(DAY) 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
				, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				, ISNULL(D31,0) AS D31, 0 AS MON_TOT
			FROM (
				SELECT   YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'C' AS GBN
					    , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
					FROM (
						SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
					        INNER JOIN TB_TASK_DEVLOP_PROCESS B
					        ON A.PROCESS_CD = B.PROCESS_CD
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
					        AND B.EXECUT_SE IS NULL
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
			                
			            UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
							
							UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					    ) S
					WHERE 1 = 1
					GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
				)  AS result
		PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	
		UNION ALL
	
		-- C (TOTAL) 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
				, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
				, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
				, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
				, SUM(MON_TOT) AS MON_TOT
		FROM (
			SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'C' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
			FROM (
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_TASK A
					    INNER JOIN TB_TASK_DEVLOP_PROCESS B
					    ON A.PROCESS_CD = B.PROCESS_CD
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
					    AND B.EXECUT_SE IS NULL
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
			            
			        UNION ALL
			        
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
					
					UNION ALL
			        
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					) S
			WHERE 1 = 1
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
	
			UNION ALL
			--   C 합계
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, TASK_CD, TASK_NM, 'A' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, 0 AS MON_TOT
			FROM TB_STS_TASK
			WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, TASK_CD, TASK_NM, 'B' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, 0 AS MON_TOT
			FROM TB_STS_TASK
			WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, TASK_CD, TASK_NM, 'C' AS GBN
					, 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
					, 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
					, 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
					, 0 AS MON_TOT
			FROM TB_STS_TASK
			WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
			) T
		WHERE 1= 1
		GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
	
		UNION ALL
	
		-- D 평균실행시간
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, ROUND(CONVERT(FLOAT , (D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31)) / EXECUT_CNT , 2) AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN , EXECUT_CNT
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, AVG(EXECUT_TM) AS EXECUT_TM , 'D' AS GBN , EXECUT_CNT
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS EXECUT_TM
										, ( SELECT COUNT(DISTINCT(YMD)) FROM TB_STS_PROC B WHERE B.PROCESS_CD = A.PROCESS_CD AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
					                FROM TB_STS_TASK A
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, EXECUT_CNT
					    )  AS result
				PIVOT ( AVG(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- E 절감시간
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, TOTAL_TM AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN , TOTAL_TM
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'E' AS GBN , MAX(REDCN_TM) AS REDCN_TM , TOTAL_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , ROUND(REDCN_TM,2) AS REDCN_TM
										, REDCN_TM AS TOTAL_TM
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, TOTAL_TM
					    )  AS result
				PIVOT ( MAX(REDCN_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- F 절감률
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN , REDCN_RATE_GROUP
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'F' AS GBN , MAX(REDCN_RATE) AS REDCN_RATE , REDCN_RATE_GROUP
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , REDCN_TM
										, JOB_TM
										, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
										, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%') -- 박해선 AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
	                            -- 오류
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, REDCN_RATE_GROUP
					    )  AS result
				PIVOT ( MAX(REDCN_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- G 가동시간
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN 
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'G' AS GBN , SUM(OPER_TM) AS OPER_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
				PIVOT ( SUM(OPER_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- H 가동률
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, D01 , D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN 
					    , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					    , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					    , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					    , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					    , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					    , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					    , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					    , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					    , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					    , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					    , ISNULL(D31,0) AS D31
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'H' AS GBN , SUM(OPER_RATE) AS OPER_RATE
					        FROM (
					            SELECT   YMD
					                    , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
										, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
				PIVOT ( SUM(OPER_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		) ZZ
	WHERE 1= 1
	GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
	
	UNION ALL
	
	SELECT  'ZZ' AS COMP_CD
	        , 'ZZ' AS COMP_NM
	        , 'ZZ' AS TASK_CD
	        , 'ZZ' AS TASK_NM
	        , GBN
	        , SUM(D01) AS D01, SUM(D02) AS D02, SUM(D03) AS D03, SUM(D04) AS D04, SUM(D05) AS D05
	        , SUM(D06) AS D06, SUM(D07) AS D07, SUM(D08) AS D08, SUM(D09) AS D09, SUM(D10) AS D10
	        , SUM(D11) AS D11, SUM(D12) AS D12, SUM(D13) AS D13, SUM(D14) AS D14, SUM(D15) AS D15
	        , SUM(D16) AS D16, SUM(D17) AS D17, SUM(D18) AS D18, SUM(D19) AS D19, SUM(D20) AS D20
	        , SUM(D21) AS D21, SUM(D22) AS D22, SUM(D23) AS D23, SUM(D24) AS D24, SUM(D25) AS D25
	        , SUM(D26) AS D26, SUM(D27) AS D27, SUM(D28) AS D28, SUM(D29) AS D29, SUM(D30) AS D30
	        , SUM(D31) AS D31, SUM(MON_TOT) AS MON_TOT                     
	FROM (
	        SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31
	                FROM (
	                        SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
	                        FROM (
	                        		SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
	                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
	                                ON A.PROCESS_CD = B.PROCESS_CD
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	                                    AND B.EXECUT_SE IS NULL
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
									
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                    )  AS result
	                PIVOT ( SUM(SUESS_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	            , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31
	                FROM (
	                        SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
	                        FROM (
	                        		SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
									INNER JOIN TB_TASK_DEVLOP_PROCESS B
									ON A.PROCESS_CD = B.PROCESS_CD
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	                                    AND B.EXECUT_SE IS NULL
	                                    
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										
									UNION ALL 
								
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
										UNION ALL 
								
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                        )  AS result
	                PIVOT ( SUM(FAIL_CNT) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	                ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31, 0 AS MON_TOT
	        FROM (
	                SELECT   YM, 'TC' AS GBN
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
	                FROM (
	                		SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								INNER JOIN TB_TASK_DEVLOP_PROCESS B
								ON A.PROCESS_CD = B.PROCESS_CD
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	                            AND B.EXECUT_SE IS NULL
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
								
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM
	                ) AS result
	        PIVOT ( SUM(SU_PER) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	
	        UNION ALL
	
	        SELECT   GBN
	                , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                , SUM(MON_TOT) AS MON_TOT
	        FROM (
	                SELECT  'TC' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	
	                UNION ALL
	
	                SELECT   'TA' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	                UNION ALL
	
	                SELECT   'TB' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
	                UNION ALL
	
	                SELECT   'TC' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TD' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TE' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TF' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TG' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                
	                UNION ALL
	
	                SELECT   'TH' AS GBN
	                        , 0 AS D01, 0 AS D02, 0 AS D03, 0 AS D04, 0 AS D05, 0 AS D06, 0 AS D07, 0 AS D08, 0 AS D09, 0 AS D10
	                        , 0 AS D11, 0 AS D12, 0 AS D13, 0 AS D14, 0 AS D15, 0 AS D16, 0 AS D17, 0 AS D18, 0 AS D19, 0 AS D20
	                        , 0 AS D21, 0 AS D22, 0 AS D23, 0 AS D24, 0 AS D25, 0 AS D26, 0 AS D27, 0 AS D28, 0 AS D29, 0 AS D30, 0 AS D31
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	                ) T
	            WHERE 1= 1
	            GROUP BY GBN
	
			UNION ALL
	
			SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , ROUND(CONVERT(FLOAT , (D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31)) / EXECUT_CNT , 2) AS MON_TOT
	        FROM (
	                SELECT   GBN , EXECUT_CNT
	        , ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
	        , ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
	        , ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
	        , ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
	        , ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
	        , ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
	        , ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
	        , ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
	        , ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
	        , ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
	        , ISNULL(D31,0) AS D31
	                FROM (
	                        SELECT YM, AVG(EXECUT_TM) AS EXECUT_TM, 'TD' AS GBN , EXECUT_CNT
	                        FROM (
	                                SELECT   YMD
	                                        , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
											, DATEDIFF(SS , A.START_TIME , A.END_DT) AS EXECUT_TM
											, ( SELECT COUNT(DISTINCT(YMD)) FROM TB_STS_PROC B WHERE 1=1 AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
	                                FROM TB_STS_TASK A
	                                WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
										AND COMP_CD =  #{searchCmpnyCd}
									</if>
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM , EXECUT_CNT
	                    )  AS result
	                PIVOT ( AVG(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
			UNION ALL
	
			SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , TOTAL_TM AS MON_TOT
	        FROM (
				SELECT   GBN , TOTAL_TM
					, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					, ISNULL(D31,0) AS D31
				FROM (
	                SELECT YM, MIN(REDCN_TM) AS EXECUT_TM, 'TE' AS GBN , TOTAL_TM
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
									, ROUND(REDCN_TM,2) AS REDCN_TM
									, REDCN_TM AS TOTAL_TM
	                        FROM TB_STS_TASK A
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , TOTAL_TM
	            )  AS result
				PIVOT ( MIN(EXECUT_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	                , REDCN_RATE_GROUP AS MON_TOT
	        FROM (
				SELECT   GBN , REDCN_RATE_GROUP
					, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
					, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
					, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
					, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
					, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
					, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
					, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
					, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
					, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
					, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
					, ISNULL(D31,0) AS D31
				FROM (
	                SELECT YM, MIN(REDCN_RATE) AS REDCN_RATE, 'TF' AS GBN , REDCN_RATE_GROUP
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
									, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
									, CONVERT(NUMERIC(13,1),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
	                        FROM TB_STS_TASK A
	                        WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%') -- 박해선 AND JOB_TM IS NOT NULL AND JOB_TM != 0 AND REDCN_TM IS NOT NULL 
	                        -- 오류
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , REDCN_RATE_GROUP
	            )  AS result
				PIVOT ( MIN(REDCN_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
	           , D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				, ISNULL(D31,0) AS D31
			FROM (
	            SELECT YM, SUM(OPER_TM) AS OPER_TM, 'TG' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
								, DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
	                    FROM TB_STS_TASK A
	                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_TM) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31
				, D01+D02+D03+D04+D05+D06+D07+D08+D09+D10+D11+D12+D13+D14+D15+D16+D17+D18+D19+D20+D21+D22+D23+D24+D25+D26+D27+D28+D29+D30+D31 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(D01,0) AS D01, ISNULL(D02,0) AS D02, ISNULL(D03,0) AS D03
				, ISNULL(D04,0) AS D04, ISNULL(D05,0) AS D05, ISNULL(D06,0) AS D06
				, ISNULL(D07,0) AS D07, ISNULL(D08,0) AS D08, ISNULL(D09,0) AS D09
				, ISNULL(D10,0) AS D10, ISNULL(D11,0) AS D11, ISNULL(D12,0) AS D12
				, ISNULL(D13,0) AS D13, ISNULL(D14,0) AS D14, ISNULL(D15,0) AS D15
				, ISNULL(D16,0) AS D16, ISNULL(D17,0) AS D17, ISNULL(D18,0) AS D18
				, ISNULL(D19,0) AS D19, ISNULL(D20,0) AS D20, ISNULL(D21,0) AS D21
				, ISNULL(D22,0) AS D22, ISNULL(D23,0) AS D23, ISNULL(D24,0) AS D24
				, ISNULL(D25,0) AS D25, ISNULL(D26,0) AS D26, ISNULL(D27,0) AS D27
				, ISNULL(D28,0) AS D28, ISNULL(D29,0) AS D29, ISNULL(D30,0) AS D30
				, ISNULL(D31,0) AS D31
			FROM (
	            SELECT YM, SUM(OPER_RATE) AS OPER_RATE, 'TH' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('D', SUBSTRING(YMD,9,2)) AS YM
								, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
	                    FROM TB_STS_TASK A
	                    WHERE YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_RATE) FOR YM IN (D01, D02, D03, D04, D05, D06, D07, D08, D09, D10, D11, D12, D13, D14, D15, D16, D17, D18, D19, D20, D21, D22, D23, D24, D25, D26, D27, D28, D29, D30, D31)) AS pivot_result
			) AA
	    WHERE 1 = 1
		) ZZ
	WHERE 1= 1
	
	GROUP BY GBN	
	ORDER BY ZZ.COMP_CD, ZZ.TASK_CD, ZZ.GBN
    -- 통계 정렬
	</select>

	<select id="selectTaskRunYearStsListV2" parameterType="java.util.Map" resultType="camelMap">
	/* ExecutStatsMapper.selectTaskRunYearStsListV2 */
	
	SET ANSI_WARNINGS OFF
    SET ARITHIGNORE ON
    SET ARITHABORT OFF
	
	SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
			, SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
            , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
            , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
            , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
            , SUM(MON_TOT) AS MON_TOT
	FROM (
		-- A 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
				, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
					     , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                         , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                         , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                         , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, SUM(SUESS_CNT) AS SUESS_CNT, 'A' AS GBN
					        FROM (
					        	SELECT YMD
				                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
				                    , COMP_CD
				                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                    , A.TASK_CD
				                    , A.TASK_NM
				                    , SUESS_CNT
				                FROM TB_STS_TASK A
				                INNER JOIN TB_TASK_DEVLOP_PROCESS B
				                ON A.PROCESS_CD = B.PROCESS_CD
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'
				                AND B.EXECUT_SE IS NULL
				                
				                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
					            
					            UNION ALL
					            
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , SUESS_CNT
				                FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY )

								UNION ALL
								-- 재실행 데이터 반영
								SELECT   YMD
				                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
				                    , COMP_CD
				                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                    , A.TASK_CD
				                    , A.TASK_NM
				                    , SUESS_CNT
				                FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
								
								UNION ALL
								
								SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , SUESS_CNT
				                FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY )

								UNION ALL
								-- 재실행 데이터 반영
								SELECT   YMD
				                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
				                    , COMP_CD
				                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
				                    , A.TASK_CD
				                    , A.TASK_NM
				                    , SUESS_CNT
				                FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
				                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				                AND STATE_CD = '5'

			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
					PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- B 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
                 , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, SUM(FAIL_CNT) AS FAIL_CNT, 'B' AS GBN
					        FROM (
					        	SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					            FROM TB_STS_TASK A
								INNER JOIN TB_TASK_DEVLOP_PROCESS B
								ON A.PROCESS_CD = B.PROCESS_CD
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					            AND STATE_CD IN ('2', '3', '4', '6')
					            AND B.EXECUT_SE IS NULL
					            
					            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		                        	AND COMP_CD =  #{searchCmpnyCd}
		                        </if>
					            
					            UNION ALL
					            
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
									
								UNION ALL
					            
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                        	AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND B.ORIGINAL_AT = 1
									AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
								UNION ALL
	
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , FAIL_CNT
					                FROM TB_STS_TASK A
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
									LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					                AND STATE_CD IN ('2', '3', '4', '6')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                        </if>
									AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
				PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- C(DAY) 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
				 , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                 , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                 , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                 , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
			FROM (
				SELECT   YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'C' AS GBN
					    , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
					FROM (
						SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
							INNER JOIN TB_TASK_DEVLOP_PROCESS B
							ON A.PROCESS_CD = B.PROCESS_CD
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
					        AND B.EXECUT_SE IS NULL
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                	AND COMP_CD =  #{searchCmpnyCd}
			                </if>
			                
			            UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
							
						UNION ALL
			            
					    SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                	AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND B.ORIGINAL_AT = 1
							AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
					            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					            , COMP_CD
					            , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					            , A.TASK_CD
					            , A.TASK_NM
					            , SUESS_CNT
					            , FAIL_CNT
					            , FAIL_CNT + SUESS_CNT AS TOT_CNT
					        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					        AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                	AND COMP_CD =  #{searchCmpnyCd}
			                </if>
							AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					    ) S
					WHERE 1 = 1
					GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
				)  AS result
		PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	
		UNION ALL
	
		-- C (TOTAL) 통계
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
				, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, SUM(MON_TOT) AS MON_TOT
		FROM (
			SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'C' AS GBN
					 , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
                     , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
			FROM (
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_TASK A
						INNER JOIN TB_TASK_DEVLOP_PROCESS B
						ON A.PROCESS_CD = B.PROCESS_CD
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
				    AND STATE_CD IN ('2', '3', '4', '5', '6')
					AND B.EXECUT_SE IS NULL
					
                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
		            	AND COMP_CD =  #{searchCmpnyCd}
		            </if>
			            
			        UNION ALL
			        
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
					
					UNION ALL
			        
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					    FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					    AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			            </if>
						AND B.ORIGINAL_AT = 1
						AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
					UNION ALL
	
					SELECT   YMD
					        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					        , COMP_CD
					        , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					        , A.TASK_CD
					        , A.TASK_NM
					        , SUESS_CNT
					        , FAIL_CNT
					        , FAIL_CNT + SUESS_CNT AS TOT_CNT
					FROM TB_STS_TASK A
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
						LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
					WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
					AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			        </if>
					AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
					) S
			WHERE 1 = 1
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
	
			UNION ALL
			--   C 합계
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, TASK_CD, TASK_NM, 'A' AS GBN
					, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
			FROM TB_STS_TASK
			WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
			                                       AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, TASK_CD, TASK_NM, 'B' AS GBN
					, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
			FROM TB_STS_TASK
			WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
	
			UNION ALL
	
			SELECT   COMP_CD, (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM, TASK_CD, TASK_NM, 'C' AS GBN
					, 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12, 0 AS MON_TOT
			FROM TB_STS_TASK
			WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
				AND COMP_CD =  #{searchCmpnyCd}
			</if>
	
			GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM
			) T
		WHERE 1= 1
		GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
	
		UNION ALL
	
		-- D 평균실행시간
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, ROUND(CONVERT(FLOAT , (M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)) / EXECUT_CNT , 2) AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN , EXECUT_CNT
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, AVG(EXECUT_TM) AS EXECUT_TM , 'D' AS GBN , EXECUT_CNT
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , A.TASK_CD
					                    , A.TASK_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS EXECUT_TM
										, ( SELECT COUNT(DISTINCT(CONCAT('M', SUBSTRING(YMD,6,2)))) FROM TB_STS_TASK B WHERE B.TASK_CD = A.TASK_CD AND YMD LIKE CONCAT(#{searchYear},'-','%')) AS EXECUT_CNT
					                FROM TB_STS_TASK A
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, EXECUT_CNT
					    )  AS result
				PIVOT ( AVG(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- E 절감시간
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, TOTAL_TM AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN , TOTAL_TM
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'E' AS GBN , MAX(REDCN_TM) AS REDCN_TM , TOTAL_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , ROUND(REDCN_TM,2) AS REDCN_TM
										, REDCN_TM AS TOTAL_TM
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM , TOTAL_TM
					    )  AS result
				PIVOT ( MAX(REDCN_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- F 절감률
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN , REDCN_RATE_GROUP
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'F' AS GBN , MAX(REDCN_RATE) AS REDCN_RATE , REDCN_RATE_GROUP
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , REDCN_TM
										, JOB_TM
										, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
										, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM , REDCN_RATE_GROUP
					    )  AS result
				PIVOT ( MAX(REDCN_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- G 가동시간
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN 
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'G' AS GBN , SUM(OPER_TM) AS OPER_TM
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
				PIVOT ( SUM(OPER_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		UNION ALL
	
		-- H 가동률
		SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
				--, REDCN_RATE_GROUP AS MON_TOT
			FROM (
				SELECT   COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN 
					    , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                        , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                        , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                        , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
					FROM (
	
					    SELECT YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM, 'H' AS GBN , SUM(OPER_RATE) AS OPER_RATE
					        FROM (
					            SELECT   YMD
					                    , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
					                    , COMP_CD
					                    , (SELECT CD_NM FROM [rpa_potal].[dbo].[TB_CMMN_CD] WHERE CLS_CD = '0024' AND CD = COMP_CD) AS COMP_NM
					                    , TASK_CD
					                    , TASK_NM
					                    , DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
										, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
					                FROM TB_STS_TASK
					            WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
	
					            ) S
					        WHERE 1 = 1
					        GROUP BY YM, COMP_CD, COMP_NM, TASK_CD, TASK_NM
					    )  AS result
				PIVOT ( SUM(OPER_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
				) AA
		WHERE 1 = 1
	
		) ZZ
	WHERE 1= 1
	GROUP BY COMP_CD, COMP_NM, TASK_CD, TASK_NM, GBN
	
	UNION ALL
	
	SELECT  'ZZ' AS COMP_CD
	        , 'ZZ' AS COMP_NM
	        , 'ZZ' AS TASK_CD
	        , 'ZZ' AS TASK_NM
	        , GBN
	        , SUM(M01) AS M01, SUM(M02) AS M02, SUM(M03) AS M03
            , SUM(M04) AS M04, SUM(M05) AS M05, SUM(M06) AS M06
            , SUM(M07) AS M07, SUM(M08) AS M08, SUM(M09) AS M09
            , SUM(M10) AS M10, SUM(M11) AS M11, SUM(M12) AS M12
            , SUM(MON_TOT) AS MON_TOT                  
	FROM (
	        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
	                FROM (
	                        SELECT YM, SUM(SUESS_CNT) AS SUESS_CNT, 'TA' AS GBN
	                        FROM (
                        		SELECT   YMD
                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
                                        , SUESS_CNT
                                FROM TB_STS_TASK A
                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
                                ON A.PROCESS_CD = B.PROCESS_CD
                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
                                   AND STATE_CD = '5'
                                   AND B.EXECUT_SE IS NULL

	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
																		
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , SUESS_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD = '5'
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                    )  AS result
	                PIVOT ( SUM(SUESS_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	            , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
	        FROM (
	                SELECT   GBN
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
	                FROM (
	                        SELECT YM, SUM(FAIL_CNT) AS FAIL_CNT, 'TB' AS GBN
	                        FROM (
	                        		SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
	                                INNER JOIN TB_TASK_DEVLOP_PROCESS B
	                                ON A.PROCESS_CD = B.PROCESS_CD
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	                                    AND B.EXECUT_SE IS NULL
	
		                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
										AND COMP_CD =  #{searchCmpnyCd}
									</if>
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
										
									UNION ALL
									
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND B.ORIGINAL_AT = 1
										AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
									UNION ALL
	
									SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                        , FAIL_CNT
	                                FROM TB_STS_TASK A
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
										LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                                    AND STATE_CD IN ('2', '3', '4', '6')
	
			                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
											AND COMP_CD =  #{searchCmpnyCd}
										</if>
										AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM
	                        )  AS result
	                PIVOT ( SUM(FAIL_CNT) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	                ) AA
	        WHERE 1 = 1
	
	        UNION ALL
	
	        SELECT   GBN
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12, 0 AS MON_TOT
	        FROM (
	                SELECT   YM, 'TC' AS GBN
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS SU_PER
	                FROM (
	                		SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
	                        INNER JOIN TB_TASK_DEVLOP_PROCESS B
	                        ON A.PROCESS_CD = B.PROCESS_CD
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	                            AND B.EXECUT_SE IS NULL
	                            
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
							
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
								
							UNION ALL
							
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_DEV_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
	                            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_DEV_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM
	                ) AS result
	        PIVOT ( SUM(SU_PER) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	
	        UNION ALL
	
	        SELECT   GBN
	                , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                , SUM(MON_TOT) AS MON_TOT
	        FROM (
	                SELECT  'TC' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , ROUND((CONVERT(FLOAT, SUM(SUESS_CNT)) / CONVERT(FLOAT,SUM(TOT_CNT)) )*100,0) AS MON_TOT
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND B.ORIGINAL_AT = 1
								AND A.JOB_ID NOT IN ( SELECT DISTINCT(RETRY_TRGET_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY)
	
							UNION ALL
	
							SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
	                                , SUESS_CNT
	                                , FAIL_CNT
	                                , FAIL_CNT + SUESS_CNT AS TOT_CNT
	                        FROM TB_STS_TASK A
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_EXECUT_HIST B ON A.JOB_ID = B.JOBS_ID
								LEFT OUTER JOIN TB_TASK_DEVLOP_PROCESS_OPER_RETRY C ON A.JOB_ID = C.JOB_ID
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                            AND STATE_CD IN ('2', '3', '4', '5', '6')
	
							    <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
									AND COMP_CD =  #{searchCmpnyCd}
								</if>
								AND A.JOB_ID IN (SELECT MAX(JOB_ID) FROM TB_TASK_DEVLOP_PROCESS_OPER_RETRY GROUP BY RETRY_TRGET_ID)
	
	                        ) S
	                WHERE 1 = 1
	
	                UNION ALL
	
	                SELECT   'TA' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	                UNION ALL
	
	                SELECT   'TB' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
	                UNION ALL
	
	                SELECT   'TC' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TD' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TE' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TF' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TG' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                
	                UNION ALL
	
	                SELECT   'TH' AS GBN
	                        , 0 AS M01, 0 AS M02, 0 AS M03, 0 AS M04, 0 AS M05, 0 AS M06, 0 AS M07, 0 AS M08, 0 AS M09, 0 AS M10, 0 AS M11, 0 AS M12
	                        , 0 AS MON_TOT
	                FROM TB_STS_TASK
	                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	                ) T
	            WHERE 1= 1
	            GROUP BY GBN
	
			UNION ALL
	
			SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , ROUND(CONVERT(FLOAT , (M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)) / EXECUT_CNT , 2) AS MON_TOT
	        FROM (
	                SELECT   GBN , EXECUT_CNT
	        , ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
            , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
            , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
            , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
	                FROM (
	                        SELECT YM, AVG(EXECUT_TM) AS EXECUT_TM, 'TD' AS GBN , EXECUT_CNT
	                        FROM (
	                                SELECT   YMD
	                                        , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
											, DATEDIFF(SS , A.START_TIME , A.END_DT) AS EXECUT_TM
											, ( SELECT COUNT(DISTINCT(CONCAT('M', SUBSTRING(YMD,6,2)))) FROM TB_STS_TASK B WHERE 1=1 AND YMD LIKE CONCAT(#{searchYear},'-',#{month},'%')) AS EXECUT_CNT
	                                FROM TB_STS_TASK A
	                                WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                        <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
										AND COMP_CD =  #{searchCmpnyCd}
									</if>
	
	                                ) S
	                        WHERE 1 = 1
	                        GROUP BY YM , EXECUT_CNT
	                    )  AS result
	                PIVOT ( AVG(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
	            ) AA
	        WHERE 1 = 1
	
			UNION ALL
	
			SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , TOTAL_TM AS MON_TOT
	        FROM (
				SELECT   GBN , TOTAL_TM
					, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                    , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                    , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                    , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
				FROM (
	                SELECT YM, MIN(REDCN_TM) AS EXECUT_TM, 'TE' AS GBN , TOTAL_TM
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
									, ROUND(REDCN_TM,2) AS REDCN_TM
									, REDCN_TM AS TOTAL_TM
	                        FROM TB_STS_TASK A
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , TOTAL_TM
	            )  AS result
				PIVOT ( MIN(EXECUT_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	                , REDCN_RATE_GROUP AS MON_TOT
	        FROM (
				SELECT   GBN , REDCN_RATE_GROUP
					, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                    , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                    , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                    , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
				FROM (
	                SELECT YM, MIN(REDCN_RATE) AS REDCN_RATE, 'TF' AS GBN , REDCN_RATE_GROUP
	                FROM (
	                        SELECT   YMD
	                                , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
									, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE
									, CONVERT(NUMERIC(13,0),(REDCN_TM / JOB_TM) * 100) AS REDCN_RATE_GROUP
	                        FROM TB_STS_TASK A
	                        WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			                <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
								AND COMP_CD =  #{searchCmpnyCd}
							</if>
	
	                        ) S
	                WHERE 1 = 1
	                GROUP BY YM , REDCN_RATE_GROUP
	            )  AS result
				PIVOT ( MIN(REDCN_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
	           , M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
			FROM (
	            SELECT YM, SUM(OPER_TM) AS OPER_TM, 'TG' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
								, DATEDIFF(SS , START_TIME , END_DT) AS OPER_TM
	                    FROM TB_STS_TASK A
	                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_TM) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
	
		UNION ALL
	
		SELECT   GBN, M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12
				, M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12 AS MON_TOT
		FROM (
			SELECT   GBN 
				, ISNULL(M01,0) AS M01, ISNULL(M02,0) AS M02, ISNULL(M03,0) AS M03
                , ISNULL(M04,0) AS M04, ISNULL(M05,0) AS M05, ISNULL(M06,0) AS M06
                , ISNULL(M07,0) AS M07, ISNULL(M08,0) AS M08, ISNULL(M09,0) AS M09
                , ISNULL(M10,0) AS M10, ISNULL(M11,0) AS M11, ISNULL(M12,0) AS M12
			FROM (
	            SELECT YM, SUM(OPER_RATE) AS OPER_RATE, 'TH' AS GBN
	            FROM (
	                    SELECT   YMD
	                            , CONCAT('M', SUBSTRING(YMD,6,2)) AS YM
								, CASE WHEN DATEDIFF(SS , START_TIME , END_DT) = 0 THEN NULL
											ELSE CONVERT(NUMERIC(13,3), CONVERT(FLOAT,DATEDIFF(SS , START_TIME , END_DT)) / 86400 * 100)
											END	AS OPER_RATE
	                    FROM TB_STS_TASK A
	                    WHERE YMD LIKE CONCAT( #{searchYear} ,'%')
	
			            <if test='searchCmpnyCd != null and searchCmpnyCd != ""'>
							AND COMP_CD =  #{searchCmpnyCd}
						</if>
	
	                    ) S
	            WHERE 1 = 1
	            GROUP BY YM
				)  AS result
			PIVOT ( SUM(OPER_RATE) FOR YM IN (M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12)) AS pivot_result
			) AA
	    WHERE 1 = 1
		) ZZ
	WHERE 1= 1

	GROUP BY GBN
	   ORDER BY ZZ.COMP_CD, ZZ.TASK_CD, ZZ.GBN
    -- 통계 정렬
	</select>
	
</mapper>